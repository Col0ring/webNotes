# dart

> å‚è€ƒè‡ª[ã€ŠDart2 ä¸­æ–‡æ–‡æ¡£ã€‹](https://www.kancloud.cn/marswill/dark2_document/709087)

## 1.å®‰è£…ä¸ä½¿ç”¨

### 1.1 å®‰è£…

**å› ä¸ºå­¦ä¹  dart å¤§å¤šæ•°æ˜¯ä¸ºäº†å†™ flutterï¼Œæ‰€ä»¥æ¨èç›´æ¥ä¸‹è½½ flutterï¼Œä¸‹è½½çš„ flutter ä¸­ä¼šå¸¦æœ‰ dart çš„ SDK**ã€‚

flutter æ¨èå»å®˜ç½‘è¿›è¡Œ[ä¸‹è½½](https://flutter.dev/docs/development/tools/sdk/releases)ã€‚ä¸‹è½½å®Œæˆåè§£å‹ï¼Œdart çš„ SDK å°±åœ¨`è§£å‹ç›®å½•\bin\cache\dart-sdk\`ä¸‹ã€‚



### 1.2 åœ¨ vscode ä¸­ä½¿ç”¨

ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† dart çš„ SDK è®¾ç½®åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼Œå°†`è§£å‹ç›®å½•\bin\cache\dart-sdk\bin`çš„å®Œæ•´è·¯å¾„è®¾ç½®å¥½ï¼Œåœ¨cmd ä¸­è¾“å…¥ dart ï¼Œæœ‰å“åº”å°±ä»£è¡¨è®¾ç½®æˆåŠŸäº†ã€‚

ç„¶åå°±æ˜¯å¦‚ä½•åœ¨ vscode ä¸­ä½¿ç”¨dartã€‚ä¸ºäº†ä½¿ç”¨ dartï¼Œæˆ‘éœ€è¦ä¸‹è½½ä¸¤ä¸ªæ’ä»¶`Dart`å’Œ`Code Runner`ï¼Œä¸‹è½½å®Œæˆååˆ›å»ºä¸€ä¸ªæ–‡ä»¶`main.dart`ï¼Œè¾“å…¥å¦‚ä¸‹ä»£ç ï¼š

```dart
// dartä¸­çš„ä»£ç éœ€è¦æ”¾å…¥mainæ–¹æ³•ä¸­æ‰§è¡Œ
main(){
    print('Hello World');
}
```

ç„¶åå³é”®`Run Code`,å¦‚æœæ§åˆ¶å°æˆåŠŸæ‰“å°å‡º`Hello World`è¯æ˜æˆ‘ä»¬å·²ç»èƒ½å¤Ÿåœ¨ vscode ä¸­ä½¿ç”¨ dart äº†ã€‚



## 2.ç±»å‹å£°æ˜

### 2.1 å˜é‡å£°æ˜

åœ¨ dart ä¸­æœ‰å¾ˆå¤šå£°æ˜å˜é‡çš„å…³é”®å­—ï¼Œå¯ä»¥ä½¿ç”¨èƒ½æ¥å—ä»»ä½•ç±»å‹å€¼çš„å˜é‡ç”³æ˜ï¼ˆç±»ä¼¼ JavaScriptï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åªèƒ½æ¥å—å›ºå®šç±»å‹å€¼çš„å˜é‡å£°æ˜ï¼ˆç±»ä¼¼ JAVAï¼‰ã€‚

#### 2.1.1 var

ç±»ä¼¼äºJavaScriptä¸­çš„`var`ï¼Œå®ƒå¯ä»¥æ¥æ”¶ä»»ä½•ç±»å‹çš„å˜é‡ï¼Œä½†æœ€å¤§çš„ä¸åŒæ˜¯ dart ä¸­`var`å˜é‡ä¸€æ—¦åœ¨å£°æ˜æ—¶è¢«èµ‹å€¼ï¼ˆé™¤äº†è¢«èµ‹å€¼ä¸º nullï¼Œå› ä¸ºåˆå§‹åŒ–çš„æ—¶å€™æ‰€æœ‰çš„å€¼éƒ½ä¸º nullï¼‰ï¼Œç±»å‹ä¾¿ä¼šç¡®å®šï¼Œåˆ™ä¸èƒ½å†æ”¹å˜å…¶ç±»å‹ï¼Œå¦‚ï¼š

```dart
var t = "hi world";
// ä¸‹é¢ä»£ç åœ¨dartä¸­ä¼šæŠ¥é”™ï¼Œå› ä¸ºå˜é‡tçš„ç±»å‹å·²ç»ç¡®å®šä¸ºString
// ç±»å‹ä¸€æ—¦ç¡®å®šååˆ™ä¸èƒ½å†æ›´æ”¹å…¶ç±»å‹
t = 1000;
```

**æ³¨ï¼š**å¯¹äºå‰ç«¯äººå‘˜æ¥è¯´ï¼Œå…¶å®çœ‹ä½œæ˜¯ TypeScript çš„è‡ªåŠ¨æ¨æ–­ç±»å‹çš„åŠŸèƒ½å°±å¥½ã€‚

ä½†æ˜¯å¦‚æœä¸€å¼€å§‹æ²¡æœ‰ç›´æ¥èµ‹å€¼ï¼Œè€Œæ˜¯åªå®šä¹‰ï¼Œé‚£ä¹ˆå˜é‡çš„ç±»å‹é»˜è®¤ä¼šæ˜¯`dynamic`ç±»å‹ï¼Œä¹Ÿå°±è¯´å’Œ JavaScript ä¸­çš„å£°æ˜çš„å˜é‡ä¸€æ ·çš„ç”¨æ³•äº†ã€‚

```dart
var t;
t = "hi world";
// ä¸‹é¢ä»£ç åœ¨dartä¸­ä¸ä¼šæŠ¥é”™
t = 1000;
```



#### 2.1.2 const å’Œ final

**å¦‚æœä»æœªæ‰“ç®—æ›´æ”¹ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆä½¿ç”¨ `final` æˆ– `const`ï¼Œä¸æ˜¯`var`ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„ç±»å‹å£°æ˜**ï¼ˆç±»å‹å£°æ˜ä¹Ÿæ˜¯å¯ä»¥æ›´æ”¹å€¼çš„ï¼Œå½“ä½¿ç”¨ç±»å‹å£°æ˜å®šä¹‰å˜é‡æ—¶ï¼Œå¯ä»¥ç›´æ¥åœ¨å‰é¢åŠ ä¸Š`const`æˆ–`final`å…³é”®å­—ä½¿å…¶å˜æˆå¸¸é‡ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬å»ºè®®çœç•¥ç±»å‹å£°æ˜ï¼‰ã€‚

**ä½¿ç”¨`const`å’Œ`final`å£°æ˜çš„å˜é‡éƒ½åªèƒ½è¢«è®¾ç½®ä¸€æ¬¡**ï¼Œä¸¤è€…åŒºåˆ«åœ¨äºï¼š

**`const`å¸¸é‡æ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡ï¼ˆå°±æ˜¯è¯´å¿…é¡»è¦æ˜¯ä¸€ä¸ªåœ¨ç¨‹åºç¼–è¯‘æ—¶å°±å®Œå…¨å›ºå®šçš„å¸¸é‡ï¼‰ï¼Œ`final`å¸¸é‡ä¸ä»…æœ‰`const`çš„ç¼–è¯‘æ—¶å¸¸é‡çš„ç‰¹æ€§ï¼Œæœ€é‡è¦çš„æ˜¯å®ƒæ˜¯è¿è¡Œæ—¶å¸¸é‡ï¼Œ`final`æ˜¯æƒ°æ€§åˆå§‹åŒ–çš„ï¼Œå³åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰ä¼šåˆå§‹åŒ–ã€‚**

```dart
// å¯ä»¥çœç•¥Stringè¿™ä¸ªç±»å‹å£°æ˜
final str = "hi world";
final String sstr = "hi world"; 
const str1 = "hi world";
const String sstr1 = "hi world";

// è¿è¡Œæ—¶å¸¸é‡åœ¨è¿è¡Œæ—¶æ‰ä¼šè¢«èµ‹å€¼
// è·å–å½“å‰æ—¶é—´ï¼Œå› ä¸ºæ˜¯åŠ¨æ€è·å–çš„ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡constå£°æ˜
final t = new DateTime.now(); // OK
const t1 = new DateTime.now(); // Error
```

**æ³¨æ„ï¼š**

- è™½ç„¶ final æ˜¯è¿è¡Œæ—¶å¸¸é‡ï¼Œç¬¬ä¸€æ¬¡è¢«èµ‹å€¼ä¹Ÿå¿…é¡»æ˜¯åœ¨å®šä¹‰çš„æ—¶å€™èµ‹å€¼ã€‚

  ```dart
  final a; // Error
  a = 1;
  ```

- å®ä¾‹å˜é‡å¯ä»¥æ˜¯ finalï¼Œä½†ä¸èƒ½æ˜¯ constã€‚ï¼ˆå®ä¾‹å˜é‡å®šä¹‰åœ¨å¯¹è±¡ä¸€çº§ï¼Œå®ƒå¯ä»¥è¢«ç±»ä¸­çš„ä»»ä½•æ–¹æ³•æˆ–è€…å…¶ä»–ç±»ä¸­çš„æ–¹æ³•è®¿é—®ï¼Œä½†æ˜¯ä¸èƒ½è¢«é™æ€æ–¹æ³•è®¿é—®ï¼‰

  ```dart
  class A {}
  main() {
      final a = new A(); // OK
      const b = new A(); // Error 
  }
  ```

- const å…³é”®å­—ä¸åªæ˜¯å£°æ˜å¸¸é‡å˜é‡ã€‚è¿˜å¯ä»¥ä½¿ç”¨å®ƒæ¥åˆ›å»ºå¸¸é‡å€¼ï¼Œä»¥åŠå£°æ˜åˆ›å»ºå¸¸é‡å€¼çš„æ„é€ å‡½æ•°ã€‚ä»»ä½•å˜é‡éƒ½å¯ä»¥èµ‹ä¸€ä¸ªå¸¸é‡å€¼ã€‚

  ```dart
  var foo = const [];
  final bar = const [];
  
  // å¯ä»¥ä»constå£°æ˜çš„åˆå§‹åŒ–è¡¨è¾¾å¼ä¸­çœç•¥const
  const baz = []; // Equivalent to `const []` => const bar = const [];
  // ä¸èƒ½æ”¹å˜constå˜é‡çš„å€¼
  baz = [42]; // Error: Constant variables can't be assigned a value.
  // å¯ä»¥æ›´æ”¹ä¸€ä¸ªéfinalçš„éconstå˜é‡çš„å€¼ï¼Œå³ä½¿å®ƒæ›¾ç»æœ‰ä¸€ä¸ªconstå€¼
  foo = [1, 2, 3]; // Was const []
  ```

- æœ‰äº›ç±»æä¾›å¸¸é‡æ„é€ å‡½æ•°ã€‚è¦ä½¿ç”¨å¸¸é‡æ„é€ å‡½æ•°åˆ›å»ºç¼–è¯‘æ—¶å¸¸é‡ï¼Œè¯·å°† const å…³é”®å­—æ”¾åœ¨æ„é€ å‡½æ•°åä¹‹å‰ï¼š

  ```dart
  class Person{
      const Person();
  }
  var p = const Person();
  ```



#### 2.1.3 dynamic å’Œ Object

- `Object` æ˜¯ dart æ‰€æœ‰å¯¹è±¡çš„æ ¹åŸºç±»ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰ç±»å‹éƒ½æ˜¯`Object`çš„å­ç±»ï¼ˆåŒ…æ‹¬`Function`å’Œ`Null`ï¼‰ï¼Œæ‰€ä»¥ä»»ä½•ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥èµ‹å€¼ç»™`Object`å£°æ˜çš„å¯¹è±¡ã€‚
- `dynamic`æ˜¯ä¸`int`è¿™æ ·ä¸€æ ·çš„ç±»å‹å…³é”®è¯ï¼Œæ”¹ç±»å‹å£°æ˜çš„å˜é‡ä¹Ÿå¯ä»¥èµ‹å€¼ä»»æ„å¯¹è±¡ã€‚

**`dynamic`ä¸`Object`ç›¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä»¬å£°æ˜çš„å˜é‡å¯ä»¥åœ¨åæœŸæ”¹å˜èµ‹å€¼ç±»å‹ï¼ˆç±»ä¼¼ä½¿ç”¨ JavaScript æˆ– TypeScript ä¸­çš„`any`ç±»å‹ï¼‰ã€‚**

```dart
dynamic t;
Object x;
t = "hi world";
x = 'Hello Object';
// ä¸‹é¢ä»£ç æ²¡æœ‰é—®é¢˜
t = 1000;
x = 1000;
```

`dynamic`ä¸`Object`ä¸åŒçš„æ˜¯ï¼Œ`dynamic`å£°æ˜çš„å¯¹è±¡ç¼–è¯‘å™¨ä¼šæä¾›æ‰€æœ‰å¯èƒ½çš„ç»„åˆï¼ˆä¹Ÿå°±æ˜¯ç›¸å½“äºå°±æ˜¯å®Œå®Œå…¨å…¨çš„ JavaScriptå˜é‡ï¼‰ï¼Œè€Œ`Object`å£°æ˜çš„å¯¹è±¡åªèƒ½ä½¿ç”¨ Object ç±»çš„å±æ€§ä¸æ–¹æ³•ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚

```dart
dynamic a;
Object b;
main() {
    a = "";
    b = "";
    printLengths();
}   

printLengths() {
    // no warning
    print(a.length);
    // warning:
    // The getter 'length' is not defined for the class 'Object'
    print(b.length);
}
```



#### 2.1.4 é»˜è®¤å€¼

æœªåˆå§‹åŒ–çš„å˜é‡çš„åˆå§‹å€¼ä¸º nullã€‚ç”šè‡³å…·æœ‰æ•°å­—ç±»å‹çš„å˜é‡æœ€åˆä¹Ÿæ˜¯ nullï¼Œå› ä¸ºåœ¨ dart ä¸­æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯å¯¹è±¡ã€‚

```dart
int lineCount;
assert(lineCount == null);
```

**æ³¨æ„ï¼š**åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œ`assert()`è°ƒç”¨è¢«å¿½ç•¥ã€‚åœ¨å¼€å‘ç¯å¢ƒä¸­å½“`assert(condition)`çš„ condition æ¡ä»¶ä¸ä¸ºçœŸæ—¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚



### 2.2 æ•°æ®ç±»å‹

**æˆ‘ä»¬è¦æ¸…æ¥šçš„æ˜¯ï¼Œdart ä¸­çš„æ‰€æœ‰ç±»å‹çš„å€¼å…¨éƒ½æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨å…¶ä»–è¯­è¨€ä¸­å¸¸ç”¨çš„åŸºæœ¬ç±»å‹å£°æ˜åœ¨ dart ä¸­å®è´¨ä¹Ÿæ˜¯ç±»çš„ç±»å‹å£°æ˜ã€‚**

#### 2.2.1 Number

**Number æ€»å…±èƒ½ä½¿ç”¨ä¸‰ç§ç±»å‹ï¼š**

- **num**
- **int**
- **double**

**Dartçš„æ•°å­—æœ‰ä¸¤ç§å½¢å¼ï¼š**

- **int**ï¼šæ ¹æ®å¹³å°çš„ä¸åŒï¼Œæ•´æ•°å€¼ä¸å¤§äº64ä½ã€‚åœ¨ Dart VM ä¸Šï¼Œå€¼å¯ä»¥ä»`-263`åˆ°`263 - 1`ã€‚ç¼–è¯‘æˆ JavaScript çš„ Dart ä½¿ç”¨ JavaScript ä»£ç ï¼Œå…è®¸å€¼ä»`-253`åˆ°`253 - 1`ã€‚

  æ•´æ•°æ˜¯æ²¡æœ‰å°æ•°ç‚¹çš„æ•°ã€‚è¿™é‡Œæœ‰ä¸€äº›å®šä¹‰æ•´æ•°å­—é¢é‡çš„ä¾‹å­ï¼š

  ```dart
  int x = 1;
  int hex = 0xDEADBEEF;
  ```

  int ç±»å‹æŒ‡å®šä¼ ç»Ÿçš„`(<<ï¼Œ >>)å’Œ(&)ï¼Œæˆ–(|)`ä½æ“ä½œç¬¦ã€‚ä¾‹å¦‚ï¼š

  ```dart
  assert((3 << 1) == 6); // 0011 << 1 == 0110
  assert((3 >> 1) == 1); // 0011 >> 1 == 0001
  assert((3 | 4) == 7); // 0011 | 0100 == 0111
  ```

- **double**ï¼š64ä½(åŒç²¾åº¦)æµ®ç‚¹æ•°ï¼Œç”±IEEE 754æ ‡å‡†æŒ‡å®šã€‚

  å¦‚æœä¸€ä¸ªæ•°å­—åŒ…å«ä¸€ä¸ªå°æ•°ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªåŒç²¾åº¦æ•°ã€‚è¿™é‡Œæœ‰ä¸€äº›å®šä¹‰åŒç²¾å­—é¢é‡çš„ä¾‹å­ï¼š

  ```dart
  double y = 1.1;
  double exponents = 1.42e5;
  ```

**æ³¨ï¼š**int å’Œ double éƒ½æ˜¯ num çš„å­ç±»å‹ã€‚num ç±»å‹åŒ…æ‹¬åŸºæœ¬çš„æ“ä½œç¬¦ï¼Œå¦‚`+ã€-ã€/å’Œ*`ï¼Œè¿˜å¯ä»¥åœ¨å…¶ä¸­æ‰¾åˆ°`abs()ã€ceil()å’Œfloor()`ç­‰æ–¹æ³•ã€‚(ä½è¿ç®—ç¬¦ï¼Œå¦‚`>>`ï¼Œåœ¨intç±»ä¸­å®šä¹‰)å¦‚æœ num åŠå…¶å­ç±»å‹æ²¡æœ‰è¦æŸ¥æ‰¾çš„å†…å®¹ï¼Œé‚£ä¹ˆ`dart:math library`å¯èƒ½ä¼šæœ‰ã€‚

**ä»¥ä¸‹æ˜¯å¦‚ä½•å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—çš„æ–¹æ³•ï¼Œåä¹‹äº¦ç„¶ï¼š**

```dart
// String -> int
var one = int.parse('1');
assert(one == 1);

// String -> double
var onePointOne = double.parse('1.1');
assert(onePointOne == 1.1);

// int -> String
String oneAsString = 1.toString();
assert(oneAsString == '1');

// double -> String
String piAsString = 3.14159.toStringAsFixed(2);
assert(piAsString == '3.14');
```



#### 2.2.2 String

dart å­—ç¬¦ä¸²æ˜¯ UTF-16 ç¼–ç å•å…ƒçš„åºåˆ—ã€‚å¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼š

```dart
var s1 = 'Single quotes work well for string literals.';
var s2 = "Double quotes work just as well.";
var s3 = 'It\'s easy to escape the string delimiter.';
var s4 = "It's even easier to use the other delimiter.";
```

å¯ä»¥ä½¿ç”¨`${expression}`å°†**è¡¨è¾¾å¼çš„å€¼**æ”¾å…¥å­—ç¬¦ä¸²ä¸­ã€‚å¦‚æœè¡¨è¾¾å¼æ˜¯**ä¸€ä¸ªæ ‡è¯†ç¬¦**ï¼Œå¯ä»¥è·³è¿‡`{}`ã€‚ä¸ºäº†è·å¾—ä¸å¯¹è±¡å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œdart ä¼šè‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„toString()æ–¹æ³•ã€‚

```dart
var s = 'string interpolation';

assert('Dart has $s, which is very handy.' ==
       'Dart has string interpolation, ' +
       'which is very handy.');
assert('That deserves all caps. ' +
       '${s.toUpperCase()} is very handy!' ==
       'That deserves all caps. ' +
       'STRING INTERPOLATION is very handy!');       
```

**æ³¨æ„ï¼š**==æ£€éªŒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²åŒ…å«ç›¸åŒåºåˆ—çš„ä»£ç å•å…ƒï¼Œé‚£ä¹ˆå®ƒä»¬æ˜¯ç­‰ä»·çš„ï¼Œè¿™ç‚¹ä¸ JavaScript ç±»ä¼¼ã€‚

å¯ä»¥ä½¿ç”¨**ç›¸é‚»çš„å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆä¹Ÿå¯ä»¥çœ‹åšæ˜¯ç”¨ç©ºæ ¼ï¼‰**æˆ– **+** è¿ç®—ç¬¦è¿æ¥å­—ç¬¦ä¸²ï¼š

```dart
var s1 = 'String ' 'concatenation' " works even over line breaks.";
assert(s1 == 'String concatenation works even over ' 'line breaks.');
var s2 = 'The + operator ' + 'works, as well.';
assert(s2 == 'The + operator works, as well.');
```

**å¯¹äºåˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼š**

- ä½¿ç”¨`\n`ç”¨åšæ¢è¡Œã€‚

- ä½¿ç”¨å¸¦æœ‰å•å¼•å·æˆ–åŒå¼•å·çš„ä¸‰é‡å¼•å·ã€‚

```dart
var s = 'a \n multi-line string'

var s1 = '''
You can create
multi-line strings like this one.
''';

var s2 = """This is also a
multi-line string.""";
```

å¦‚æœä¸æƒ³è¦è½¬ä¹‰å­—ç¬¦ä½ å¯ä»¥ç”¨`r`å‰ç¼€åˆ›å»ºä¸€ä¸ª**åŸå§‹å­—ç¬¦ä¸²**ï¼š

```dart
var s = r'In a raw string, not even \n gets special treatment.';
// In a raw string, not even \n gets special treatment.
```

**è¦æ³¨æ„ä¸€ç‚¹ï¼Œå­—ç¬¦ä¸²å­—é¢é‡æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ï¼Œåªè¦ä»»ä½•å†…æ’è¡¨è¾¾å¼éƒ½æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ï¼Œè®¡ç®—ç»“æœä¸º null æˆ–æ•°å€¼ã€å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼ã€‚**

```dart
// These work in a const string.
const aConstNum = 0;
const aConstBool = true;
const aConstString = 'a constant string';

// These do NOT work in a const string.
var aNum = 0;
var aBool = true;
var aString = 'a string';
const aConstList = [1, 2, 3];

const validConstString = '$aConstNum $aConstBool $aConstString';
// const invalidConstString = '$aNum $aBool $aString $aConstList'; // Error
/*
å‰ä¸‰ä¸ªé”™è¯¯å› ä¸ºä½¿ç”¨varè¿›è¡Œç”³æ˜çš„ï¼Œvarå£°æ˜çš„å˜é‡ä¹‹åå¯ä»¥æ”¹å˜å€¼ï¼Œä¸ç¬¦åˆå¸¸é‡å®šä¹‰ï¼Œè€Œåä¸€ä¸ªæ˜¯å› ä¸ºä¸ç¬¦åˆå¸¸é‡æ‰€éœ€ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ä¸ç¬¦åˆnullæˆ–æ•°å€¼ã€å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼ã€‚å³ä½¿ä½¿ç”¨toString()æ–¹æ³•ä¹Ÿä¼šæŠ¥é”™ï¼Œè¿™ä¸ç¬¦åˆç¼–è¯‘æ—¶å¸¸é‡çš„å®šä¹‰ï¼Œé™¤éç”¨final
*/
```



#### 2.2.3 Boolean

**ä¸ºäº†è¡¨ç¤ºå¸ƒå°”å€¼ï¼Œdart æœ‰ä¸€ä¸ªåä¸º bool çš„ç±»å‹ã€‚åªæœ‰ä¸¤ä¸ªå¯¹è±¡å…·æœ‰ bool ç±»å‹ï¼šå¸ƒå°”å­—é¢é‡ true å’Œ falseï¼Œå®ƒä»¬éƒ½æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚**

dart çš„ç±»å‹å®‰å…¨æ€§æ„å‘³ç€ä¸èƒ½ä½¿ç”¨`if(ébooleanvalue)`æˆ–`assert(ébooleanvalue)`ä¹‹ç±»çš„ä»£ç ã€‚ç›¸åï¼Œæ˜¾å¼åœ°æ£€æŸ¥å€¼ï¼Œå¦‚ï¼š

```dart
// Check for an empty string.
var fullName = '';
assert(fullName.isEmpty);

// Check for zero.
var hitPoints = 0;
assert(hitPoints <= 0);

// Check for null.
var unicorn;
assert(unicorn == null);

// Check for NaN.
var iMeantToDoThis = 0 / 0;
assert(iMeantToDoThis.isNaN);
```



#### 2.2.4 List

åªè¦ Listã€Setã€Map ç­‰çš„åŸºæœ¬ç”¨æ³•è§ [dart å¸¸ç”¨åº“çš„ä½¿ç”¨](#12.dart å¸¸ç”¨åº“çš„ä½¿ç”¨)

> [Lst API æ–‡æ¡£](https://api.dartlang.org/stable/dart-core/List-class.html)

**ä¹Ÿè®¸å‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€ä¸­æœ€å¸¸è§çš„é›†åˆå°±æ˜¯æ•°ç»„æˆ–æœ‰åºå¯¹è±¡ç»„ã€‚åœ¨ dart ä¸­ï¼Œæ•°ç»„æ˜¯åˆ—è¡¨å¯¹è±¡ï¼Œæ‰€ä»¥å¤§å¤šæ•°äººæŠŠå®ƒä»¬å«åšåˆ—è¡¨ã€‚**

dart åˆ—è¡¨å­—é¢é‡çœ‹èµ·æ¥åƒ JavaScript æ•°ç»„å­—é¢é‡ã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ dart åˆ—è¡¨ï¼š

```dart
var list = [1, 2, 3];
```

**æ³¨æ„ï¼š**ä¸Šé¢çš„ä»£ç åˆ†æå™¨æ¨æ–­è¯¥åˆ—è¡¨å…·æœ‰`List<int>`ç±»å‹ã€‚å¦‚æœè¯•å›¾å‘æ­¤åˆ—è¡¨æ·»åŠ éæ•´å‹å¯¹è±¡ï¼Œåˆ™åˆ†æå™¨æˆ–è¿è¡Œæ—¶å°†å¼•å‘é”™è¯¯ã€‚

**å¯ä»¥è·å–åˆ—è¡¨çš„é•¿åº¦ï¼Œå¹¶å¼•ç”¨åˆ—è¡¨å…ƒç´ ï¼Œå°±åƒåœ¨JavaScriptä¸­é‚£æ ·ï¼š**

```dart
var list = [1, 2, 3];
assert(list.length == 3);
assert(list[1] == 2);

list[1] = 1;
assert(list[1] == 1);
```

**è¦åˆ›å»ºä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡åˆ—è¡¨ï¼ˆä¸èƒ½å†ä¹‹åæ”¹å˜å€¼ï¼‰ï¼Œéœ€è¦åœ¨åˆ—è¡¨å­—é¢é‡ä¹‹å‰æ·»åŠ  constï¼ˆæˆ–è€…ç›´æ¥ä½¿ç”¨ const ç”³æ˜å˜é‡ï¼‰ï¼š**

```dart
var constantList = const [1, 2, 3];
// OR
const constantList = [1, 2, 3];
// constantList[1] = 1; // Uncommenting this causes an error.
// è¿™é‡Œä¸ä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥é”™ï¼Œä½†æ˜¯è¿è¡Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸
```

åˆ—è¡¨ç±»å‹æœ‰è®¸å¤šä¾¿äºæ“ä½œåˆ—è¡¨çš„æ–¹æ³•ï¼Œåœ¨è¿™é‡Œä¸è¯´ï¼Œåœ¨ä¹‹åä¼šè¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚



#### 2.2.5 Set

>  [Set API æ–‡æ¡£](https://api.dartlang.org/stable/dart-core/Set-class.html)

dart ä¸­çš„é›†åˆæ˜¯ä¸€ç»„æ— åºçš„ç‹¬ç‰¹ç‰©å“é›†åˆã€‚å› ä¸ºé›†åˆæ˜¯æ— åºçš„ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ç´¢å¼•ï¼ˆä½ç½®ï¼‰è·å¾—é›†åˆçš„é¡¹ã€‚

```dart
var ingredients = Set();
ingredients.addAll(['gold', 'titanium', 'xenon']);
assert(ingredients.length == 3);

// Adding a duplicate item has no effect.
ingredients.add('gold');
assert(ingredients.length == 3);

// Remove an item from a set.
ingredients.remove('gold');
assert(ingredients.length == 2);
```

ä½¿ç”¨`contains()`å’Œ`containsAll()`æ¥æ£€æŸ¥é›†åˆä¸­æ˜¯å¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ï¼š

```dart
var ingredients = Set();
ingredients.addAll(['gold', 'titanium', 'xenon']);

// Check whether an item is in the set.
assert(ingredients.contains('titanium'));

// Check whether all the items are in the set.
assert(ingredients.containsAll(['titanium', 'xenon']));
```

äº¤é›†æ˜¯ä¸€ä¸ªé›†åˆï¼Œå…¶é¡¹åœ¨å¦å¤–ä¸¤ä¸ªé›†åˆä¸­ï¼š

```dart
var ingredients = Set();
ingredients.addAll(['gold', 'titanium', 'xenon']);

// Create the intersection of two sets.
var nobleGases = Set.from(['xenon', 'argon']);
var intersection = ingredients.intersection(nobleGases);
assert(intersection.length == 1);
assert(intersection.contains('xenon'));
```



#### 2.2.6 Map

> [Map API æ–‡æ¡£](https://api.dartlang.org/stable/dart-core/Map-class.html)

é€šå¸¸ï¼Œmap æ˜¯ä¸€ä¸ªå…³è”é”®å’Œå€¼çš„å¯¹è±¡ã€‚**é”®å’Œå€¼éƒ½å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¯¹è±¡**ã€‚æ¯ä¸ªé”®åªå‡ºç°ä¸€æ¬¡ï¼Œä½†æ˜¯æ‚¨å¯ä»¥å¤šæ¬¡ä½¿ç”¨ç›¸åŒçš„å€¼ã€‚dart å¯¹ map çš„æ”¯æŒæ˜¯é€šè¿‡ map å­—é¢é‡å’Œ map ç±»å‹æ¥æä¾›çš„ã€‚(å¯ä»¥çœ‹åšæ˜¯æ··å…¥äº† JavaScript å¯¹è±¡å­—é¢é‡å†™æ³•å’Œ JAVA çš„ HashMap é”®å€¼çš„å¯¹è±¡)

```dart
var gifts = {
  // Key:    Value
  'first': 'partridge',
  'second': 'turtledoves',
  'fifth': 'golden rings'
};

var nobleGases = {
  2: 'helium',
  10: 'neon',
  18: 'argon',
};
```

**æ³¨æ„ï¼š**

- åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œè§£æå™¨æ¨æ–­ gifts çš„ç±»å‹ä¸º`Map<String, String>`ï¼ŒnobleGases çš„ç±»å‹ä¸º`Map<int, String>`ã€‚å¦‚æœæ‚¨è¯•å›¾å‘ map æ·»åŠ é”™è¯¯ç±»å‹çš„å€¼ï¼Œåˆ™åˆ†æå™¨æˆ–è¿è¡Œæ—¶å°†å¼•å‘é”™è¯¯ã€‚

- dart ä¸­çš„ map å’Œ JavaScript ä¸­çš„å¯¹è±¡æ˜¯æœ‰åŒºåˆ«çš„ï¼Œé”®ï¼ˆkeyï¼‰å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ï¼Œå¹¶ä¸”å¦‚æœæ˜¯ String ç±»å‹çš„è¯ä¸èƒ½çœç•¥å¼•å·ï¼Œå› ä¸ºåœ¨ dart ä¸­è¿™æ ·ä¼šå°†å…¶è§£æä¸ºä¸€ä¸ªå˜é‡ã€‚

  ```dart
  const a = '1';
  var map1 = {
      true: '123',
      a: '2', // ä¸åŠ å¼•å·çš„aä¼šè¢«è§£æä¸º'1'
      b: '2', // æŠ¥é”™ï¼Œæ²¡æœ‰bå˜é‡
      'a': '2'
  };
  ```
  
- åŒæ ·çš„ï¼Œåœ¨é€šè¿‡ map çš„é”®è·å–å€¼å¾—æ—¶å€™ï¼Œä¸èƒ½ä½¿ç”¨ JavaScript ä¸­å¸¸è§çš„`ç‚¹ï¼ˆ.ï¼‰`æ“ä½œç¬¦ï¼Œåªèƒ½ä½¿ç”¨`[]`æ“ä½œç¬¦ï¼Œ**`ç‚¹ï¼ˆ.ï¼‰`æ“ä½œç¬¦åªèƒ½ç”¨åœ¨è·å– dart ä¸­é€šè¿‡ç±»ç”Ÿæˆçš„å¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•ä¸­ï¼ˆå› ä¸º map ç”Ÿæˆçš„è‡ªå˜é‡åªæ˜¯çœ‹èµ·æ¥å’Œ JavaScript ä¸­çš„ä¸€æ ·ï¼Œå®é™…ä¸Šè¿˜æ˜¯æœ‰å¾ˆå¤§å·®åˆ«çš„ï¼‰**ã€‚

**åŒæ ·å¯ä»¥ä½¿ç”¨Mapæ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡:**

```dart
var gifts = new Map();
gifts['first'] = 'partridge';
gifts['second'] = 'turtledoves';
gifts['fifth'] = 'golden rings';

var nobleGases = new Map();
nobleGases[2] = 'helium';
nobleGases[10] = 'neon';
nobleGases[18] = 'argon';
```

**æ·»åŠ å€¼å’Œæ£€ç´¢å€¼éƒ½å¦‚åŒ JavaScript ä¸­é‚£æ ·è¿›è¡Œï¼Œä¸åŒçš„æ˜¯ï¼š**

- å¦‚æœè¦è·å–çš„é”®ä¸å† map ä¸­ï¼Œå°†ä¼šè¿”å›ä¸€ä¸ª nullï¼š

    ```dart
    var gifts = {'first': 'partridge'};
    assert(gifts['fifth'] == null);
    ```

- å¯ä»¥ä½¿ç”¨`.length`è·å– map ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼š

    ```dart
    var gifts = {'first': 'partridge'};
    gifts['fourth'] = 'calling birds';
    assert(gifts.length == 2);
    ```

**è¦åˆ›å»ºä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡çš„ map éœ€è¦åœ¨ map çš„å­—é¢é‡å‰åŠ `const`å…³é”®å­—ï¼ˆæˆ–ç›´æ¥ä½¿ç”¨ const å£°æ˜çš„å˜é‡ï¼‰ï¼š**

```dart
var constantMap = const {
  2: 'helium',
  10: 'neon',
  18: 'argon',
};
// OR
const constantMap = {
  2: 'helium',
  10: 'neon',
  18: 'argon',
};

// constantMap[2] = 'Helium'; // Uncommenting this causes an error.
// è¿™é‡Œä¸ä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥é”™ï¼Œä½†æ˜¯è¿è¡Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸
```



#### 2.2.7 Runesï¼ˆå­—ç¬¦ï¼‰

**åœ¨ dart ä¸­ï¼Œå­—ç¬¦æ˜¯å­—ç¬¦ä¸²çš„UTF-32ç¼–ç ç‚¹ã€‚**

Unicode ä¸ºä¸–ç•Œä¸Šæ‰€æœ‰çš„ä¹¦å†™ç³»ç»Ÿä¸­ä½¿ç”¨çš„æ¯ä¸ªå­—æ¯ã€æ•°å­—å’Œç¬¦å·å®šä¹‰ä¸€ä¸ªå”¯ä¸€çš„æ•°å€¼ã€‚å› ä¸º dart å­—ç¬¦ä¸²æ˜¯ UTF-16 ä»£ç å•å…ƒçš„åºåˆ—ï¼Œæ‰€ä»¥åœ¨å­—ç¬¦ä¸²ä¸­è¡¨ç¤º32ä½çš„ Unicode å€¼éœ€è¦ç‰¹æ®Šçš„è¯­æ³•ã€‚

è¡¨ç¤º Unicode ç ç‚¹çš„å¸¸ç”¨æ–¹æ³•æ˜¯`\uXXXX`ï¼Œå…¶ä¸­ XXXX æ˜¯4ä½æ•°çš„åå…­è¿›åˆ¶å€¼ã€‚ä¾‹å¦‚,å¿ƒå‹å­—ç¬¦(â™¥)çš„ç¼–ç ä¸º`\u2665`ã€‚è¦æŒ‡å®šå¤§äºæˆ–å°äº4ä½åå…­è¿›åˆ¶æ•°å­—ï¼Œè¯·å°†å€¼æ”¾åœ¨èŠ±æ‹¬å·ä¸­ã€‚ä¾‹å¦‚ç¬‘è„¸è¡¨æƒ…(ğŸ˜†)çš„ç¼–ç `\u{1f600}`ã€‚

**String ç±»æœ‰å‡ ä¸ªå±æ€§å¯ä»¥ç”¨æ¥è·å– runesä¿¡æ¯ã€‚codeUnitAt å’Œ codeUnit å±æ€§è¿”å›16ä½ä»£ç å•å…ƒã€‚ä½¿ç”¨å­—ç¬¦å±æ€§è·å–å­—ç¬¦ä¸²çš„å­—ç¬¦ã€‚**

**ä¸‹é¢çš„ç¤ºä¾‹è¯´æ˜äº†å­—ç¬¦ã€16ä½ä»£ç å•å…ƒå’Œ32ä½ä»£ç ç‚¹ä¹‹é—´çš„å…³ç³»ï¼š**

```dart
main() {
  var clapping = '\u{1f600}';
  print(clapping);
  print(clapping.codeUnits);
  print(clapping.runes.toList());

  Runes input = new Runes(
      '\u2665  \u{1f605}  \u{1f60e}  \u{1f47b}  \u{1f596}  \u{1f44d}');
  print(new String.fromCharCodes(input));
}

//è¿è¡Œæ•ˆæœå¦‚ä¸‹
ğŸ˜€
[55357, 56832]
[128512]
â™¥  ğŸ˜…  ğŸ˜  ğŸ‘»  ğŸ––  ğŸ‘

Process finished with exit code 0
```

**æ³¨æ„ï¼š**ä½¿ç”¨åˆ—è¡¨æ“ä½œæ“ä½œ runes æ—¶è¦å°å¿ƒã€‚æ ¹æ®ç‰¹å®šçš„è¯­è¨€ã€å­—ç¬¦é›†å’Œæ“ä½œï¼Œè¿™ç§æ–¹æ³•å¾ˆå®¹æ˜“å‡ºé”™ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§[å¦‚ä½•åœ¨Dartä¸­åè½¬å­—ç¬¦ä¸²?](https://stackoverflow.com/questions/21521729/how-do-i-reverse-a-string-in-dart)



#### 2.2.8 Symbolsï¼ˆç¬¦å·ï¼‰

ç¬¦å·å¯¹è±¡è¡¨ç¤ºåœ¨ dart ç¨‹åºä¸­å£°æ˜çš„æ“ä½œç¬¦æˆ–æ ‡è¯†ç¬¦ã€‚ä¸€èˆ¬æ¥è¯´å¯èƒ½æ°¸è¿œä¸éœ€è¦ä½¿ç”¨ç¬¦å·ï¼Œä½†æ˜¯å¯¹äºæŒ‰åç§°å¼•ç”¨æ ‡è¯†ç¬¦çš„api æ¥è¯´ï¼Œå®ƒä»¬æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºç¼©å°æ”¹å˜äº†æ ‡è¯†ç¬¦åç§°è€Œä¸æ˜¯æ ‡è¯†ç¬¦ç¬¦å·ã€‚

è¦è·å–æ ‡è¯†ç¬¦çš„ç¬¦å·ï¼Œè¯·ä½¿ç”¨ç¬¦å·æ–‡å­—ï¼Œç¬¦å·æ–‡å­—ä»…ä¸º`#`ï¼Œåé¢è·Ÿç€æ ‡è¯†ç¬¦ï¼š

```dart
#radix
#bar
```

**æ³¨æ„ï¼š**ç¬¦å·å¸¸é‡æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚



#### 2.2.9 æšä¸¾ç±»å‹

**æšä¸¾ç±»å‹å¯ä»¥çœ‹åšæ˜¯ dart å¯¹ç±»ï¼ˆclassï¼‰çš„ä¸€ç§å»¶ä¼¸ã€‚**

ä½¿ç”¨`enum`å…³é”®å­—å£°æ˜ä¸€ä¸ªæšä¸¾ç±»å‹ï¼š

```dart
enum Color { red, green, blue }
```

æšä¸¾ä¸­çš„æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªç´¢å¼• getterï¼Œå®ƒè¿”å›`enum`å£°æ˜ä¸­å€¼çš„ä»0å¼€å§‹çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªå€¼æœ‰ç´¢å¼•0ï¼Œç¬¬äºŒä¸ªå€¼æœ‰ç´¢å¼•1ã€‚

```dart
assert(Color.red.index == 0);
assert(Color.green.index == 1);
assert(Color.blue.index == 2);
```

ä½¿ç”¨`enum`çš„`values`å¸¸é‡è¦è·å–æšä¸¾ä¸­æ‰€æœ‰å€¼çš„åˆ—è¡¨ã€‚

```dart
List<Color> colors = Color.values;
assert(colors[2] == Color.blue);
```

å¯ä»¥åœ¨ switch è¯­å¥ä¸­ä½¿ç”¨`enum`ï¼Œå¦‚æœ switch çš„ case ä¸å¤„ç†`enum`çš„æ‰€æœ‰å€¼ï¼Œå°†ä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šæ¶ˆæ¯ï¼š

```dart
var aColor = Color.blue;

switch (aColor) {
  case Color.red:
    print('Red as roses!');
    break;
  case Color.green:
    print('Green as grass!');
    break;
  default: // Without this, you see a WARNING.
    print(aColor); // 'Color.blue'
}
```

**æšä¸¾ç±»å‹æœ‰ä»¥ä¸‹é™åˆ¶:**

- ä¸èƒ½å­ç±»åŒ–ã€æ··åˆæˆ–å®ç°æšä¸¾ã€‚
- ä¸èƒ½æ˜¾å¼å®ä¾‹åŒ–ä¸€ä¸ªæšä¸¾ã€‚



## 3.è¿ç®—ç¬¦

dart å®šä¹‰äº†ä¸‹è¡¨ä¸­æ˜¾ç¤ºçš„æ“ä½œç¬¦ã€‚æ‚¨å¯ä»¥é‡å†™å…¶ä¸­çš„è®¸å¤šæ“ä½œç¬¦ï¼Œå¦‚å¯é‡å†™æ“ä½œç¬¦ä¸­æ‰€è¿°ï¼š

| æè¿°                 | æ“ä½œç¬¦                                                       |
| :------------------- | :----------------------------------------------------------- |
| ä¸€å…ƒåç½®æ“ä½œç¬¦       | expr++ â€‚â€‚ expr-- â€‚â€‚ () â€‚â€‚ [] â€‚â€‚ . â€‚â€‚ ?.                      |
| ä¸€å…ƒå‰ç½®æ“ä½œç¬¦       | -expr â€‚â€‚ !expr â€‚â€‚ ~expr â€‚â€‚ ++expr â€‚â€‚ --expr                  |
| ä¹˜é™¤è¿ç®—             | * â€‚â€‚ / â€‚â€‚ % â€‚â€‚ ~/                                            |
| åŠ å‡è¿ç®—             | + â€‚â€‚ -                                                       |
| ç§»ä½è¿ç®—             | << â€‚â€‚ >>                                                     |
| æŒ‰ä½ä¸               | &                                                            |
| æŒ‰ä½å¼‚æˆ–             | ^                                                            |
| æŒ‰ä½æˆ–               | \|                                                           |
| å…³ç³»å’Œç±»å‹æµ‹è¯•       | >= â€‚â€‚ > â€‚â€‚ <= â€‚â€‚ < â€‚â€‚ as â€‚â€‚ is â€‚â€‚ is!                        |
| ç›¸ç­‰                 | == â€‚â€‚ ï¼=                                                    |
| é€»è¾‘ä¸               | &&                                                           |
| é€»è¾‘æˆ–               | \|\|                                                         |
| æ˜¯å¦ä¸ºnull           | ??                                                           |
| å¤©å¥åˆ¤æ–­ï¼ˆä¸‰å…ƒè¿ç®—ï¼‰ | expr1 ? expr2 : expr3                                        |
| çº§è”                 | ..                                                           |
| èµ‹å€¼                 | = â€‚â€‚ *= â€‚â€‚ /= â€‚â€‚ ~/= â€‚â€‚ %= â€‚â€‚ += â€‚â€‚ -= â€‚â€‚ <<= â€‚â€‚ >>= â€‚â€‚ &= â€‚â€‚ ^= |

### 3.1 ç®—æœ¯è¿ç®—ç¬¦

dart ä¸­çš„ç®—æœ¯è¿ç®—ç¬¦ä¸å…¶ä»–è¯­è¨€å¤§ä½“æ˜¯ç±»ä¼¼çš„ï¼Œä¸è¿‡æœ‰ä¸€ç‚¹ä¸ä¸€è‡´çš„æ˜¯ï¼Œdart ä¸­çš„é™¤æ³•æ˜¯ç¬¦åˆæˆ‘ä»¬ç”Ÿæ´»ä¸­çš„æ­£å¸¸è¿ç®—çš„ï¼Œå³ä½¿æ˜¯`int`ç±»å‹çš„å€¼ä¹Ÿä¼šæœ‰å°æ•°çš„ç»“æœå‡ºç°ï¼š

```dart
print(3 / 2); // 1.5 not 1
```

å¦‚æœæƒ³è¦åƒå…¶ä»–è¯­è¨€ä¸€ç›´å–æ•´ï¼Œéœ€è¦ä½¿ç”¨`~/`è¿ç®—ç¬¦ï¼š

```dart
print(3 ~/ 2);// 1
```



### 3.2 ç›¸ç­‰å’Œå…³ç³»è¿ç®—ç¬¦

**åŒå…¶å®ƒç±»å‹è¯­è¨€ï¼Œç•¥ã€‚**



### 3.3 ç±»å‹æµ‹è¯•æ“ä½œç¬¦

**`as`ï¼Œ`is`å’Œ`is!`æ“ä½œç¬¦å¯ä»¥æ–¹ä¾¿åœ°åœ¨è¿è¡Œæ—¶æ£€æŸ¥ç±»å‹ã€‚**

| æ“ä½œç¬¦ | è¯´æ˜                              |
| :----- | :-------------------------------- |
| as     | å½¢æ€è½¬æ¢                          |
| is     | å¦‚æœå¯¹è±¡å…·æœ‰æŒ‡å®šçš„ç±»å‹ï¼Œåˆ™ä¸ºTrue  |
| is!    | å¦‚æœå¯¹è±¡å…·æœ‰æŒ‡å®šçš„ç±»å‹ï¼Œåˆ™ä¸ºFalse |

- å¯¹äº is æ“ä½œç¬¦ï¼Œå¦‚æœ obj å®ç°äº† T æŒ‡å®šçš„æ¥å£ï¼Œåˆ™`obj is T`ä¸º0çœŸã€‚ä¾‹å¦‚ï¼Œ`obj is Object`æ€»æ˜¯ä¸ºçœŸï¼ˆä¹Ÿå°±æ˜¯è¯´åœ¨å¯¹ä»»ä½•çˆ¶ç±»ä½¿ç”¨ is æ“ä½œç¬¦éƒ½ä¼šè¿”å›çœŸï¼‰ã€‚

- ä½¿ç”¨ as æ“ä½œç¬¦å°†å¯¹è±¡è½¬æ¢ä¸ºç‰¹å®šç±»å‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥å°†å…¶ä½œä¸º is æµ‹è¯•çš„ç®€å†™å½¢å¼ï¼Œä»¥ä½¿ç”¨è¯¥å¯¹è±¡çš„è¡¨è¾¾å¼å¯¹å¯¹è±¡è¿›è¡Œæµ‹è¯•ï¼š

    ```dart
    if (emp is Person) {
        // Type check
        emp.firstName = 'Bob';
    }
    ```
    
    ä½¿ç”¨asæ“ä½œç¬¦å¯ä»¥ä½¿ä»£ç æ›´ç®€çŸ­:

    ```dart
    (emp as Person).firstName = 'Bob';
    ```

**æ³¨æ„ï¼š**ä¸Šé¢ä¸¤ä¸ªä¾‹å­çš„ä»£ç ä¸ç­‰æ•ˆã€‚å¦‚æœ emp æ˜¯ null æˆ–ä¸æ˜¯ Personï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼ˆä½¿ç”¨ isï¼‰ä¹ˆéƒ½ä¸åšï¼›ç¬¬äºŒä¸ªï¼ˆå¸¦æœ‰ asï¼‰æŠ›å‡ºå¼‚å¸¸ã€‚



### 3.4 èµ‹å€¼æ“ä½œç¬¦

dart çš„èµ‹å€¼æ“ä½œç¬¦å’Œå¤åˆèµ‹å€¼æ“ä½œç¬¦ä¹Ÿå’Œå…¶ä»–è¯­è¨€çš„ç±»ä¼¼ï¼Œä¹Ÿæœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œè‹¥è¦ä»…ä»…ä¸ºç©ºçš„å˜é‡èµ‹å€¼å¯ä»¥ä½¿ç”¨`??=`æ“ä½œç¬¦ã€‚

```dart
// Assign value to a
a = value;
// Assign value to b if b is null; otherwise, b stays the same
///ä»…ä»…åœ¨bä¸ºç©ºçš„æƒ…å†µä¸‹bè¢«èµ‹å€¼valueå¦åˆ™bçš„å€¼ä¸å˜
b ??= value;
```



### 3.5 é€»è¾‘è¿ç®—ç¬¦

**æœ‰`!`ã€`&&`å’Œ`||`ï¼ŒåŒå…¶å®ƒç±»å‹è¯­è¨€ï¼Œç•¥ã€‚**



### 3.6 ä½å’Œç§»ä½è¿ç®—

**å¯ä»¥æ“çºµ dart ä¸­çš„å•ä¸ªæ•°å­—ä½ã€‚é€šå¸¸ï¼Œä¼šä½¿ç”¨è¿™äº›ä½å’Œç§»ä½è¿ç®—ç¬¦ã€‚**

| è¿ç®—ç¬¦ | è¯´æ˜     |
| :----- | :------- |
| &      | æŒ‰ä½ä¸   |
| \|     | æŒ‰ä½æˆ–   |
| ^      | æŒ‰ä½å¼‚æˆ– |
| ~expr  | æŒ‰ä½å–å |
| <<     | å·¦ç§»     |
| >>     | å³ç§»     |

ä¸‹ä¾‹æ˜¯ä½¿ç”¨ä½è¿ç®—ç¬¦å’Œå”¯ä¸€è¿ç®—ç¬¦çš„ç¤ºä¾‹ï¼š

```dart
final value = 0x22;
final bitmask = 0x0f;

assert((value & bitmask) == 0x02); // AND
assert((value & ~bitmask) == 0x20); // AND NOT
assert((value | bitmask) == 0x2f); // OR
assert((value ^ bitmask) == 0x2d); // XOR
assert((value << 4) == 0x220); // Shift left
assert((value >> 4) == 0x02); // Shift right
```



### 3.7 æ¡ä»¶è¡¨è¾¾å¼

dart ä¸­æœ‰ä¸¤ä¸ªè¿ç®—ç¬¦ï¼Œå¯ä»¥ç²¾ç¡®åœ°è®¡ç®—é‚£äº›å¯èƒ½éœ€è¦`if-else`è¯­å¥çš„è¡¨è¾¾å¼ï¼š

- **condition ? expr1 : expr2ï¼ˆä¸‰ç›®è¡¨è¾¾å¼ï¼‰ï¼š**å¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œåˆ™è®¡ç®— expr1ï¼ˆå¹¶è¿”å›å…¶å€¼ï¼‰ï¼›å¦åˆ™ï¼Œè®¡ç®—å¹¶è¿”å› expr2 çš„å€¼ã€‚

- **expr1 ?? expr2ï¼š**å¦‚æœ expr1 æ˜¯éç©ºçš„ï¼Œåˆ™è¿”å›å…¶å€¼ï¼›å¦åˆ™ï¼Œè®¡ç®—å¹¶è¿”å› expr2 çš„å€¼ã€‚

å½“éœ€è¦åŸºäºå¸ƒå°”è¡¨è¾¾å¼çš„ç»“æœé€‰æ‹©èµ‹å€¼ï¼Œè¯·è€ƒè™‘ä½¿ç”¨ ***?:*** ã€‚

```dart
var visibility = isPublic ? 'public' : 'private';
```

å¦‚æœå¸ƒå°”è¡¨è¾¾å¼åªæƒ³åˆ¤æ–­å€¼æ˜¯å¦ä¸º nullï¼Œè¯·è€ƒè™‘ä½¿ç”¨ ***??*** ã€‚

```dart
String playerName(String name) => name ?? 'Guest';
```



### 3.8 çº§è”è¡¨ç¤ºæ³• ï¼ˆ..ï¼‰

**çº§è”ï¼ˆ..ï¼‰å…è®¸åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šåˆ›å»ºä¸€ä¸ªæ“ä½œåºåˆ—ã€‚é™¤äº†å‡½æ•°è°ƒç”¨ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è®¿é—®åŒä¸€å¯¹è±¡ä¸Šçš„å­—æ®µã€‚è¿™é€šå¸¸å¯ä»¥çœå»åˆ›å»ºä¸´æ—¶å˜é‡çš„æ­¥éª¤ï¼Œèƒ½æ›´ä¸ºæµç•…çš„å†™ä»£ç ã€‚**

**çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š**

```dart
querySelector('#confirm') // Get an object.
  ..text = 'Confirm' // Use its members.
  ..classes.add('important')
  ..onClick.listen((e) => window.alert('Confirmed!'));
```

é¦–å…ˆè°ƒç”¨`querySelector()`æ–¹æ³•è¿”å›ä¸€ä¸ª`selector`å¯¹è±¡ã€‚è·Ÿéšçº§è”è¡¨ç¤ºæ³•çš„ä»£ç **å¯¹è¿™ä¸ªé€‰æ‹©å™¨å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œå¿½ç•¥å¯èƒ½è¿”å›çš„ä»»ä½•åç»­å€¼ã€‚**

**æ³¨æ„ï¼š**åœ¨çº§è”çš„æ—¶å€™ï¼Œè·å–çš„å¯¹è±¡çš„ç¬¬ä¸€ä¸ªå±æ€§æˆ–æ–¹æ³•å¼€å§‹å°±éœ€è¦ä½¿ç”¨`..`ï¼Œå…¨ç¨‹éƒ½ä¸èƒ½ä½¿ç”¨å•ç‹¬çš„`.`ã€‚

ç­‰ä»·äºï¼š

```dart
var button = querySelector('#confirm');
button.text = 'Confirm';
button.classes.add('important');
button.onClick.listen((e) => window.alert('Confirmed!'));
```

**ä¹Ÿå¯ä»¥åµŒå¥—çº§è”æ“ä½œã€‚ä¾‹å¦‚ï¼š**

```dart
final addressBook = (AddressBookBuilder()
      ..name = 'jenny'
      ..email = 'jenny@example.com'
      ..phone = (PhoneNumberBuilder()
            ..number = '415-555-0100'
            ..label = 'home')
          .build())
    .build();
```

ä¸è¿‡ï¼Œåœ¨è¿”å›å®é™…å¯¹è±¡çš„å‡½æ•°ä¸Šæ„é€ çº§è”è¦å°å¿ƒï¼Œå¯èƒ½æˆ‘ä»¬éœ€è¦çº§è”çš„è¡¨è¾¾å¼æ ¹æœ¬å°±æ²¡æœ‰è¿”å›ç»™æˆ‘ä»¬æ­£ç¡®çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ä¼šå‡ºé”™ï¼š

```dart
var sb = StringBuffer();
sb.write('foo')
  ..write('bar'); // Error: method 'write' isn't defined for 'void'.
// sb.write()è¿”å›ç»“æœä¸ºvoidï¼Œæ‰€ä»¥ä¸èƒ½å†ä¸€ä¸ªvoidç»“æœä¸Šç»§ç»­æ„å»ºçº§è”æ“ä½œã€‚
```

**æ³¨æ„ï¼š**ä¸¥æ ¼åœ°è¯´ï¼Œçº§è”ï¼ˆ..ï¼‰è¡¨ç¤ºæ³•ä¸æ˜¯è¿ç®—ç¬¦ã€‚è¿™åªæ˜¯ dart è¯­æ³•çš„ä¸€éƒ¨åˆ†ã€‚



### 3.9 å…¶å®ƒè¿ç®—ç¬¦ï¼ˆä¸»è¦æ˜¯ ?.ï¼‰

| è¿ç®—ç¬¦ | åç§°             | è¯´æ˜                                                         |
| :----- | :--------------- | :----------------------------------------------------------- |
| ()     | åŠŸèƒ½å‡½æ•°         | è¡¨ç¤ºä¸€ä¸ªå‡½æ•°è°ƒç”¨                                             |
| []     | è®¿é—®åˆ—è¡¨         | å¼•ç”¨åˆ—è¡¨ä¸­æŒ‡å®šç´¢å¼•å¤„çš„å€¼                                     |
| .      | è®¿é—®æˆå‘˜         | è¡¨ç¤ºè¡¨è¾¾å¼çš„å±æ€§;ä¾‹å¦‚:foo.barä»è¡¨è¾¾å¼fooä¸­é€‰æ‹©å±æ€§bar        |
| ?.     | æ ¹æ®æ¡ä»¶è®¿é—®æˆå‘˜ | å’Œ(.)ç›¸ä¼¼ï¼Œä½†æ˜¯å·¦è¾¹çš„æ“ä½œæ•°å¯ä»¥ä¸ºç©ºï¼›ä¾‹å¦‚ï¼š`foo?.bar`ä»fooçš„è¡¨è¾¾å¼ä¸­é€‰æ‹©barå±æ€§ï¼Œå¦‚æœfooä¸ºç©ºåˆ™è¿”å›null |

è¿™é‡Œè¯´æ˜ä¸€ä¸‹`.`å’Œ`?.`ï¼š

```dart	
class A {
    var b;
}

void main() {
    /// aobjä¸ºAçš„ä¸€ä¸ªå®ä¾‹
    var aobj = A();
    ///zä¸ºç©ºå€¼çš„å˜é‡
    var z=null;
    print(aobj.b);
    print(z?.b); // null
    // å¦‚æœæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è¯´æ˜éƒ½ä¸ä¼šå‘ç”Ÿ
    
    print(z.b); // exception
}
```



## 4.å‡½æ•°

**dart æ˜¯ä¸€ç§çœŸæ­£çš„é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œæ‰€ä»¥å³ä½¿æ˜¯å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªç±»å‹ Functionã€‚è¿™æ„å‘³ç€å‡½æ•°å¯ä»¥èµ‹å€¼ç»™å˜é‡æˆ–ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œè¿™æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„å…¸å‹ç‰¹å¾ã€‚**

### 4.1 å‡½æ•°å£°æ˜

```dart
bool isNoble(int atomicNumber) {
  return _nobleGases[atomicNumber] != null;
}
```

**å¯¹äºåªåŒ…å«ä¸€ä¸ªè¡¨è¾¾å¼çš„å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ç®€å†™è¯­æ³•ï¼ˆç±»ä¼¼ JavaScript ä¸­çš„ç®­å¤´å‡½æ•°ï¼‰ï¼š**

```dart
bool isNoble (int atomicNumber)=> _nobleGases [ atomicNumber ] != null ;
```

**æ³¨æ„ï¼š**åœ¨`ç®­å¤´(=>)`å’Œ`åˆ†å·(;)`ä¹‹é—´åªèƒ½å‡ºç°ä¸€ä¸ªè¡¨è¾¾å¼(ä¸æ˜¯è¯­å¥)ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½åœ¨é‚£é‡Œæ”¾ä¸€ä¸ª`if`è¯­å¥ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼ã€‚



### 4.2 å‡½æ•°èµ‹å€¼

- å‡½æ•°ä½œä¸ºå˜é‡

  ```dart
  var say = (str){
    print(str);
  };
  say("hi world");
  ```

- å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’

  ```dart
  void execute(var callback) {
      callback();
  }
  execute(() => print("xxx"))
  ```




### 4.3 main å‡½æ•°

æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½å¿…é¡»æœ‰ä¸€ä¸ªé¡¶çº§çš„`main()`å‡½æ•°ï¼Œå®ƒä½œä¸ºåº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚`main()`å‡½æ•°è¿”å›`void`ï¼Œå¹¶æœ‰ä¸€ä¸ªå¯é€‰çš„åˆ—è¡¨å‚æ•°ä½œä¸ºå‚æ•°ã€‚

```dart
void main() {
  querySelector('#sample_text_id')
    ..text = 'Click me!'
    ..onClick.listen(reverseText);
}
```

**ä¸‹é¢æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºçš„main()å‡½æ•°ç¤ºä¾‹ï¼Œå®ƒæ¥å—å‚æ•°ï¼š**

```dart
// Run the app like this: dart args.dart 1 test
void main(List<String> arguments) {
  print(arguments);

  assert(arguments.length == 2);
  assert(int.parse(arguments[0]) == 1);
  assert(arguments[1] == 'test');
}
```

**æ³¨ï¼š**å¯ä»¥ä½¿ç”¨`args`åº“æ¥å®šä¹‰å’Œè§£æå‘½ä»¤è¡Œå‚æ•°ã€‚



### 4.4 å‡½æ•°å‚æ•°

> **ä¸èƒ½åŒæ—¶ä½¿ç”¨å¯é€‰çš„ä½ç½®å‚æ•°å’Œå¯é€‰çš„å‘½åå‚æ•°**

å¯é€‰çš„ä½ç½®å‚æ•°å’Œå¯é€‰çš„å‘½åå‚æ•°éƒ½èƒ½å’Œæ™®é€šçš„å‡½æ•°å‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚

#### 4.4.1 å¯é€‰çš„ä½ç½®å‚æ•°

åŒ…è£…ä¸€ç»„å‡½æ•°å‚æ•°ï¼Œç”¨`[]`æ ‡è®°ä¸ºå¯é€‰çš„ä½ç½®å‚æ•°ï¼Œå¹¶æ”¾åœ¨å‚æ•°åˆ—è¡¨çš„æœ€åé¢

```dart
String say(String from, String msg, [String device]) {
  var result = '$from says $msg';
  if (device != null) {
    result = '$result with a $device';
  }
  return result;
}
```

ä¸‹é¢æ˜¯ä¸€ä¸ªä¸å¸¦å¯é€‰å‚æ•°è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„ä¾‹å­ï¼š

```dart
say('Bob', 'Howdy'); //ç»“æœæ˜¯ï¼š Bob says Howdy
```

ä¸‹é¢æ˜¯ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„ä¾‹å­ï¼š

```dart
say('Bob', 'Howdy', 'smoke signal'); //ç»“æœæ˜¯ï¼šBob says Howdy with a smoke signal
```



#### 4.4.2 å¯é€‰çš„å‘½åå‚æ•°

å®šä¹‰å‡½æ•°æ—¶ï¼Œä½¿ç”¨`{param1, param2, â€¦}`ï¼Œæ”¾åœ¨å‚æ•°åˆ—è¡¨çš„æœ€åé¢ï¼Œç”¨äºæŒ‡å®šå‘½åå‚æ•°ã€‚ä¾‹å¦‚ï¼š

```dart
//è®¾ç½®[bold]å’Œ[hidden]æ ‡å¿—
void enableFlags({bool bold, bool hidden}) {
    // ... 
}
```

è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨`paramName: value`æ¥æŒ‡å®šå‘½åå‚æ•°ã€‚ä¾‹å¦‚:

```dart
enableFlags(bold: true, hidden: false);
```

å¯é€‰å‘½åå‚æ•°åœ¨ flutter ä¸­ä½¿ç”¨éå¸¸å¤šï¼Œå¯ä»¥åœ¨ä»»ä½• dart ä»£ç ï¼ˆä¸ä»…ä»…æ˜¯ flutterï¼‰ä¸­æ³¨é‡Šä¸€ä¸ªå·²å‘½åçš„å‚æ•°ï¼Œå¹¶ä½¿ç”¨`@required`è¯´æ˜å®ƒæ˜¯ä¸€ä¸ªå¿…ä¼ çš„å‚æ•°ã€‚ä¾‹å¦‚:

```dart
const Scrollbar({Key key, @required Widget child})
```

å½“æ„é€ Scrollbaræ—¶ï¼Œåˆ†æå™¨åœ¨æ²¡æœ‰å­å‚æ•°ï¼ˆchildï¼‰æ—¶æŠ¥é”™ã€‚

**æ³¨ï¼š**`Required`åœ¨å…ƒåŒ…ä¸­è¢«å®šä¹‰ã€‚æˆ–è€…ç›´æ¥ä½¿ç”¨`import package:meta/meta.dart`å¯¼å…¥æˆ–è€…å¯¼å…¥å…¶ä»–åŒ…å« meta å¯¼å‡ºçš„åŒ…ï¼Œä¾‹å¦‚ flutter çš„åŒ…:`Flutter /material.dart`ã€‚



#### 4.4.3 é»˜è®¤å‚æ•°å€¼

å¯ä»¥ä½¿ç”¨ = æ¥å®šä¹‰å‘½åå’Œä½ç½®å‚æ•°çš„é»˜è®¤å€¼ã€‚**é»˜è®¤å€¼å¿…é¡»æ˜¯ç¼–è¯‘æ—¶å¸¸é‡**ã€‚å¦‚æœæ²¡æœ‰æä¾›é»˜è®¤å€¼ï¼Œåˆ™é»˜è®¤å€¼ä¸º nullã€‚

**æ³¨æ„ï¼š**å‡½æ•°çš„é»˜è®¤å‚æ•°å€¼åªèƒ½å†™åœ¨å¯é€‰çš„ä½ç½®å‚æ•°ï¼ˆ`{}`ï¼‰å’Œå¯é€‰çš„å‘½åå‚æ•°(`[]`)å†…ã€‚

ä¸‹é¢æ˜¯ä¸ºå‘½åå‚æ•°è®¾ç½®é»˜è®¤å€¼çš„ç¤ºä¾‹ï¼š

```dart
/// Sets the [bold] and [hidden] flags ...
void enableFlags({bool bold = false, bool hidden = false}) {...}

// bold will be true; hidden will be false.
enableFlags(bold: true);
```

ä¸‹ä¸€ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•è®¾ç½®ä½ç½®å‚æ•°çš„é»˜è®¤å€¼ï¼š

```dart
String say(String from, String msg,
    [String device = 'carrier pigeon', String mood]) {
  var result = '$from says $msg';
  if (device != null) {
    result = '$result with a $device';
  }
  if (mood != null) {
    result = '$result (in a $mood mood)';
  }
  return result;
}

assert(say('Bob', 'Howdy') ==
    'Bob says Howdy with a carrier pigeon');
    
```

è¿˜å¯ä»¥å°† list æˆ– map é›†åˆä½œä¸ºé»˜è®¤å€¼ã€‚ä¸‹é¢çš„ç¤ºä¾‹å®šä¹‰ä¸€ä¸ªå‡½æ•°`doStuff()`ï¼Œè¯¥å‡½æ•°æŒ‡å®šåˆ—è¡¨å‚æ•°çš„é»˜è®¤åˆ—è¡¨å’Œç¤¼å“å‚æ•°çš„é»˜è®¤mapé›†åˆï¼š

```dart
void doStuff(
    {List<int> list = const [1, 2, 3],
    Map<String, String> gifts = const {
      'first': 'paper',
      'second': 'cotton',
      'third': 'leather'
    }}) {
  print('list:  $list');
  print('gifts: $gifts');
}
```



### 4.5 åŒ¿åå‡½æ•°

**å¤§å¤šæ•°å‡½æ•°éƒ½è¢«å‘½åï¼Œå¦‚`main()`æˆ–`printElement()`ã€‚ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰å‡½æ•°åç§°çš„å‡½æ•°ï¼Œè¿™ç§å‡½æ•°ç§°ä¸ºåŒ¿åå‡½æ•°ï¼Œæˆ–è€… lambda å‡½æ•°æˆ–è€…é—­åŒ…å‡½æ•°ã€‚** 

ä¸è¿‡å¯ä»¥ä¸ºå˜é‡åˆ†é…ä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä»é›†åˆä¸­æ·»åŠ æˆ–åˆ é™¤å®ƒã€‚

åŒ¿åå‡½æ•°çœ‹èµ·æ¥ç±»ä¼¼äºå‘½åå‡½æ•°ï¼šæœ‰0ä¸ªæˆ–è€…å¤šä¸ªå‚æ•°ï¼Œåœ¨æ‹¬å·ä¹‹é—´ç”¨é€—å·å’Œå¯é€‰ç±»å‹æ ‡æ³¨åˆ†éš”ï¼Œåé¢çš„ä»£ç å—åŒ…å«å‡½æ•°çš„ä¸»ä½“ã€‚

```dart
([[Type] param1[, â€¦]]) { 
  codeBlock; 
}; 
```

ä¸‹é¢çš„ç¤ºä¾‹å®šä¹‰äº†ä¸€ä¸ªå¸¦æœ‰æ— ç±»å‹å‚æ•° item çš„åŒ¿åå‡½æ•°ã€‚è¯¥å‡½æ•°ä¸ºåˆ—è¡¨ä¸­çš„æ¯ä¸ª item è°ƒç”¨ï¼Œæ‰“å°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²åŒ…å«æŒ‡å®šç´¢å¼•çš„å€¼ï¼š

```dart
var list = ['apples', 'bananas', 'oranges'];
list.forEach((item) {
  print('${list.indexOf(item)}: $item');
});
```

å¦‚æœå‡½æ•°åªåŒ…å«ä¸€æ¡è¯­å¥ï¼Œå¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼š

```dart
var list = ['apples', 'bananas', 'oranges'];
list.forEach((item) => print('${list.indexOf(item)}: $item'));
```



### 4.6 ç®­å¤´å‡½æ•°

åœ¨ dart ä¸­çš„ç®­å¤´å‡½æ•°çš„ç”¨æ³•å’Œ JavaScript ä¸­ç®­å¤´å‡½æ•°åªå†™ä¸€è¡Œç›´æ¥è¿”å›å€¼æ˜¯ç±»ä¼¼çš„æ•ˆæœï¼Œä¸è¿‡æœ‰æ‰€åŒºåˆ«çš„æ˜¯ dart ä¸­åªæœ‰ç®€ä¾¿å†™æ³•è¿™ä¸ªåŠŸèƒ½ï¼Œæ— æ³•ä¿®æ”¹`this`çš„æŒ‡å‘é—®é¢˜ã€‚

åŒæ—¶ dart ä¸­çš„ç®­å¤´å‡½æ•°åªèƒ½å†™ä¸€è¡Œè¡¨è¾¾å¼ï¼Œæ²¡æœ‰`{}`å‡½æ•°ä½“ï¼Œè™½ç„¶èƒ½åœ¨æœ€å¤–å±‚åŒ…è£¹ä¸€å±‚`{}`ï¼Œä½†è¿™ä¸ä»£è¡¨å‡½æ•°ä½“ï¼Œè€Œæ˜¯ä¸€ä¸ª Set ç±»å‹çš„æ•°æ®ã€‚ `{}`ä¸ä»…åœ¨å®šä¹‰å‡½æ•°çš„æ—¶å€™ç”¨åˆ°ï¼Œåœ¨æ„å»º `Setã€Mapé›†åˆå­—é¢é‡` çš„æ—¶å€™ä¹Ÿç”¨åˆ°äº†ã€‚

**æ³¨æ„ï¼š**å¦‚æœæ˜¯å•ç‹¬å£°æ˜çš„ç®­å¤´å‡½æ•°ï¼Œæœ€åéƒ½å¿…é¡»è¦åŠ ä¸Šåˆ†å·`;`ä½œä¸ºç»“å°¾ã€‚

```dart
// ä¸‹é¢çš„testè¿”å›å€¼æ˜¯{null}ï¼Œå› ä¸º if (true) {print("success")} è¿™ä¸ªè¯­å¥çš„è¿”å›å€¼æ˜¯null
test() => {
    if (true) {print("success")}
};
main() {
  print(test().runtimeType);
}

// è¾“å‡º
/*
_CompactLinkedHashSet<Set<void>>
*/
```



### 4.7 å‡½æ•°é—­åŒ…

dart ä¸­çš„å‡½æ•°é—­åŒ…å’Œå‡½æ•°ä½œç”¨åŸŸçš„é—®é¢˜å’Œ JavaScript ä¸­çš„ä¸€è‡´ï¼Œç•¥ã€‚



### 4.8 è¿”å›å€¼

æ‰€æœ‰å‡½æ•°éƒ½è¿”å›ä¸€ä¸ªå€¼ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šè¿”å›å€¼ï¼Œåˆ™è¯­å¥è¿”å› nullã€‚

```dart
foo() {}
assert(foo() == null);
```

dart ä¸­çš„å‡½æ•°å£°æ˜**å¦‚æœæ˜¯å†™åœ¨å…¨å±€æ²¡æœ‰æ˜¾å¼å£°æ˜**è¿”å›å€¼ç±»å‹æ—¶ä¼šé»˜è®¤å½“åš`dynamic`å¤„ç†ã€‚

**æ³¨æ„ï¼š**

- å†™åœ¨å…¨å±€çš„å’Œç±»ä¸­çš„å‡½æ•°è¿”å›å€¼æ²¡æœ‰ç±»å‹æ¨æ–­ã€‚
- å†™åœ¨å‡½æ•°å†…éƒ¨ï¼ˆåŒ…æ‹¬ main å‡½æ•°ï¼‰çš„å‡½æ•°æœ‰ç±»å‹æ¨æ–­ï¼Œä¸å†™`return`è¿”å›å€¼æ˜¯ Null ç±»å‹ï¼Œå¦‚æœè¿”å›æ¡ä»¶æœ‰å¾ˆå¤šç§ä¼šè¿”å› Object ç±»å‹ã€‚

```dart
typedef bool CALLBACK();

// ä¸æŒ‡å®šè¿”å›ç±»å‹ï¼Œæ­¤æ—¶é»˜è®¤ä¸ºdynamicï¼Œä¸æ˜¯bool
isNoble(int atomicNumber) {
  return _nobleGases[atomicNumber] != null;
}

void test(CALLBACK cb) {
  print(cb());
}

main() {
  /*
  // è¿”å›ç±»å‹èƒ½æ¨æ–­å‡ºæ˜¯bollï¼Œå†™åœ¨é‡Œé¢ä¸‹é¢çš„ä»£ç ä¸ä¼šæŠ¥é”™
    isNoble(int atomicNumber) {
      return _nobleGases[atomicNumber] != null;
    }
  */
  // æŠ¥é”™ï¼ŒisNobleä¸æ˜¯boolç±»å‹
  test(isNoble);
}
```



## 5.ç±»

dart æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œå…·æœ‰ç±»å’ŒåŸºäº mixin çš„ç»§æ‰¿ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œæ‰€æœ‰çš„ç±»éƒ½æ˜¯ Object çš„å­ç±»ã€‚åŸºäº mixin çš„ç»§æ‰¿æ„å‘³ç€ï¼Œå°½ç®¡æ¯ä¸ªç±»ï¼ˆé™¤äº† Objectï¼‰éƒ½åªæœ‰ä¸€ä¸ªè¶…ç±»ï¼Œä½†ç±»ä¸»ä½“å¯ä»¥åœ¨å¤šä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­é‡ç”¨ã€‚

### 5.1 ç±»çš„åŸºæœ¬ä½¿ç”¨

#### 5.1.1 ä½¿ç”¨ç±»æˆå‘˜

dart ä¸­çš„ç±»çš„æˆå‘˜ä½¿ç”¨ä¸ JavaScript ä¸­çš„ç±»ä¼¼ï¼Œåœ¨ä½¿ç”¨æ—¶åªæœ‰äº›è®¸çš„ä¸åŒã€‚

**ä½¿ç”¨ç‚¹å·ï¼ˆ.ï¼‰å¼•ç”¨å®ä¾‹å˜é‡æˆ–æ–¹æ³•ï¼š**

```dart
var p = Point(2, 2);

// Set the value of the instance variable y.
p.y = 3;

// Get the value of y.
assert(p.y == 3);

// Invoke distanceTo() on p.
num distance = p.distanceTo(Point(4, 4));
```

**ä¸ºé¿å…æœ€å·¦æ“ä½œæ•°ä¸ºç©ºæ—¶å‡ºç°å¼‚å¸¸ï¼Œä½¿ç”¨ `?.`ä»£æ›¿`.`æ¥ä½¿ç”¨ï¼š**

```dart
// If p is non-null, set its y value to 4.
p?.y = 4;
```



#### 5.1.2 ä½¿ç”¨æ„é€ å‡½æ•°

å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚æ„é€ å‡½æ•°åå¯ä»¥æ˜¯ ClassName æˆ– ClassName.identifierï¼ˆå¯ä»¥çœ‹åšæ˜¯ç±»ä¼¼é‡è½½å‡½æ•°çš„æ„é€ å‡½æ•°ï¼‰ã€‚

**æ³¨ï¼š**åœ¨ dart ä¸­ new å…³é”®å­—ä¸ºå¯é€‰å…³é”®å­—ã€‚

```dart
var p1 = Point(2, 2);
var p2 = Point.fromJson({'x': 1, 'y': 2});
```

ä¸‹é¢çš„ä»£ç å…·æœ‰ç›¸åŒçš„æ•ˆæœï¼Œä½†æ˜¯åœ¨æ„é€ å‡½æ•°åä¹‹å‰ä½¿ç”¨å¯é€‰çš„ new å…³é”®å­—ï¼š

```dart
var p1 = new Point(2, 2);
var p2 = new Point.fromJson({'x': 1, 'y': 2});
```

**æœ‰äº›ç±»æä¾›å¸¸é‡æ„é€ å‡½æ•°ã€‚è¦ä½¿ç”¨å¸¸é‡æ„é€ å‡½æ•°åˆ›å»ºç¼–è¯‘æ—¶å¸¸é‡ï¼Œè¯·å°† const å…³é”®å­—æ”¾åœ¨æ„é€ å‡½æ•°åä¹‹å‰ï¼š**

```dart
class Person{
    const Person();
}
var p = const Person();
```

æ„é€ ä¸¤ä¸ªç›¸åŒçš„ç¼–è¯‘æ—¶å¸¸é‡ä¼šç”Ÿæˆä¸€ä¸ªå•ä¸€çš„ã€è§„èŒƒçš„å®ä¾‹ï¼ˆå¯ä»¥çœ‹åšå°±æ˜¯å•ä¾‹æ¨¡å¼ï¼‰ï¼š

```dart
var a = const ImmutablePoint(1, 1);
var b = const ImmutablePoint(1, 1);

assert(identical(a, b)); // They are the same instance!
```

å½“ç„¶ï¼Œå’Œå‰é¢è®² const ä¸€æ ·ï¼Œåœ¨å¸¸é‡ä¸Šä¸‹æ–‡ä¸­ï¼Œå¯ä»¥åœ¨æ„é€ å‡½æ•°æˆ–æ–‡å­—ä¹‹å‰çœç•¥ constï¼š

```dart
// Lots of const keywords here.
const pointAndLine = const {
  'point': const [const ImmutablePoint(0, 0)],
  'line': const [const ImmutablePoint(1, 10), const ImmutablePoint(-2, 11)],
};
```

é™¤äº†ç¬¬ä¸€æ¬¡ä½¿ç”¨constå…³é”®å­—ä¹‹å¤–å…¶ä»–çš„constéƒ½å¯ä»¥çœç•¥ï¼ˆèƒ½è‡ªåŠ¨é€’å½’æ•ˆæœï¼‰ï¼š

```dart
// Only one const, which establishes the constant context.
const pointAndLine = {
  'point': [ImmutablePoint(0, 0)],
  'line': [ImmutablePoint(1, 10), ImmutablePoint(-2, 11)],
};
```



#### 5.1.3 è·å¾—å¯¹è±¡çš„ç±»å‹

è¦åœ¨è¿è¡Œæ—¶è·å¾—å¯¹è±¡ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨å¯¹è±¡çš„`runtimeType`å±æ€§ï¼Œè¯¥å±æ€§è¿”å›ä¸€ä¸ªç±»å‹å¯¹è±¡ã€‚

```dart
print('The type of a is ${a.runtimeType}');
```



#### 5.1.4 å®ä¾‹å˜é‡

**æ‰€æœ‰æœªåˆå§‹åŒ–çš„å®ä¾‹å˜é‡éƒ½å…·æœ‰ null å€¼ã€‚**

ä¸‹é¢æ˜¯å¦‚ä½•å£°æ˜å®ä¾‹å˜é‡çš„æ–¹æ³•ï¼š

```dart
class Point {
  num x; // Declare instance variable x, initially null.
  num y; // Declare y, initially null.
  num z = 0; // Declare z, initially 0.
}
```

**æ‰€æœ‰å®ä¾‹å˜é‡éƒ½ç”Ÿæˆéšå¼getteræ–¹æ³•ã€‚éæœ€ç»ˆå®ä¾‹å˜é‡ä¹Ÿç”Ÿæˆéšå¼setteræ–¹æ³•ã€‚**

```dart
class Point {
  num x;
  num y;
}

void main() {
  var point = Point();
  point.x = 4; // Use the setter method for x.
  assert(point.x == 4); // Use the getter method for x.
  assert(point.y == null); // Values default to null.
}
```

å¦‚æœåœ¨å£°æ˜å®ä¾‹å˜é‡çš„åœ°æ–¹ï¼ˆè€Œä¸æ˜¯åœ¨æ„é€ å‡½æ•°æˆ–æ–¹æ³•ä¸­ï¼‰åˆå§‹åŒ–å®ä¾‹å˜é‡ï¼Œåˆ™åœ¨åˆ›å»ºå®ä¾‹æ—¶ï¼ˆåœ¨æ„é€ å‡½æ•°åŠå…¶åˆå§‹åŒ–åˆ—è¡¨æ‰§è¡Œä¹‹å‰ï¼‰è®¾ç½®è¯¥å€¼ã€‚



### 5.2 æ„é€ å‡½æ•°

**é€šè¿‡åˆ›å»ºä¸€ä¸ªä¸ç±»åŒåçš„å‡½æ•°æˆ–æ·»åŠ ä¸€ä¸ªé™„åŠ æ ‡è¯†ç¬¦æ¥å£°æ˜æ„é€ å‡½æ•°ã€‚**

```dart
class Point {
  num x, y;

  Point(num x, num y) {
    // There's a better way to do this, stay tuned.
    this.x = x;
    this.y = y;
  }
}
```

**æ³¨æ„ï¼š**

- this å…³é”®å­—æ˜¯æŒ‡å½“å‰å®ä¾‹ã€‚
- ä¸ Java ä¸­ç±»ä¼¼ï¼Œthis åœ¨æ²¡æœ‰å‘½åå†²çªçš„æ—¶å€™æ˜¯å¯ä»¥çœç•¥çš„.

å¯ä»¥ç›´æ¥é€šè¿‡ä¸‹é¢è¿™ç§æ–¹æ³•å®ç°æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ç›´æ¥ç»™å¯¹åº”çš„å®ä¾‹ï¼ˆä¸ TypeScript ä¸­ç›´æ¥åœ¨å½¢å‚ä¸Šå†™ä¸Šå±æ€§ä¿®è¾ç¬¦çš„ç”¨æ³•æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼‰ï¼š

```dart
class Point {
  num x, y;

  // Syntactic sugar for setting x and y
  // before the constructor body runs.
  Point(this.x, this.y);
}
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸Šä½¿ç”¨å¯é€‰çš„ä½ç½®å‚æ•°ã€å‘½åå‚æ•°å’Œé»˜è®¤å€¼ï¼š

```dart
//ä¸‹é¢è¿™æ ·å†™ä¹Ÿæ˜¯å¯è¡Œçš„
class Point {
  num x, y;
  Point({this.x = 1, this.y});
}

void main() {
  // ä¸Šé¢çš„thisæ˜¯è¯­æ³•åŒï¼Œæœ¬è´¨è¿˜æ˜¯xå’Œy
  var p = new Point(y: 2);
  print(p.x);
  print(p.y);
}
```



**ä¸‹é¢ä¸¤ç‚¹ä¸ JAVA ä¸­çš„æ„é€ å‡½æ•°ç±»ä¼¼ï¼š**

- **é»˜è®¤æ„é€ å‡½æ•°ï¼š**å¦‚æœä¸å£°æ˜æ„é€ å‡½æ•°ï¼ˆåŒ…æ‹¬å‘½åæ„é€ å‡½æ•°ï¼‰ï¼Œåˆ™æä¾›é»˜è®¤æ„é€ å‡½æ•°ã€‚é»˜è®¤æ„é€ å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œå¹¶åœ¨è¶…ç±»ä¸­è°ƒç”¨æ— å‚æ•°æ„é€ å‡½æ•°ã€‚

- **æ„é€ å‡½æ•°ä¸æ˜¯ç»§æ‰¿ï¼š**å¯¹äºå­ç±»å’Œçˆ¶ç±»æ¥è¯´ï¼Œå­ç±»ä¸ä»çˆ¶ç±»ç»§æ‰¿æ„é€ å‡½æ•°ã€‚æ²¡æœ‰å£°æ˜æ„é€ å‡½æ•°çš„å­ç±»åªæœ‰é»˜è®¤çš„æ„é€ å‡½æ•°ï¼ˆæ²¡æœ‰å‚æ•°ï¼Œæ²¡æœ‰åç§°ï¼‰è€Œä¸æ˜¯ä»çˆ¶ç±»ç»§æ‰¿çš„æ„é€ å‡½æ•°ã€‚
  - å­ç±»å¿…é¡»è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„æ— å‚æ„é€ å‡½æ•°ï¼Œå¦‚æœçˆ¶ç±»æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°,åˆ™å¿…é¡»æ˜¾å¼çš„ç”¨`super()`è°ƒç”¨ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚
  - åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°å¯¹å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ï¼Œç„¶åå†è°ƒç”¨å­ç±»è‡ªå·±çš„æ„é€ å‡½æ•°ã€‚
  - å­ç±»åªé»˜è®¤è°ƒç”¨çˆ¶ç±»çš„é»˜è®¤ï¼ˆæ— å‚ï¼‰æ„é€ å‡½æ•°ï¼Œå¦‚æœçˆ¶ç±»é‡å†™äº†è‡ªå·±çš„æ„é€ å‡½æ•°ï¼Œå°±ä¼šå¯¼è‡´çˆ¶ç±»æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°ï¼Œè¿™æ ·å­ç±»å°±ä¸èƒ½ä»çˆ¶ç±»ç»§æ‰¿æ„é€ å‡½æ•°ã€‚



#### 5.2.1 å‘½åçš„æ„é€ å‡½æ•°

ä½¿ç”¨å‘½åæ„é€ å‡½æ•°å¯ä»¥åœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œæˆ–è€…è®©ä¸€ä¸ªç±»çš„ä½œç”¨å¯¹äºå¼€å‘äººå‘˜æ¥è¯´æ›´æ¸…æ™°ï¼š

```dart
class Point {
  num x, y;

  Point(this.x, this.y);

  // Named constructor
  Point.origin() {
    x = 0;
    y = 0;
  }
}
```

**æ³¨ï¼š**å› ä¸ºæ„é€ å‡½æ•°æ˜¯ä¸ä¼šä»çˆ¶ç±»ç»§æ‰¿çš„ï¼Œè¿™æ„å‘³ç€çˆ¶ç±»çš„å‘½åæ„é€ å‡½æ•°å­ç±»ä¹Ÿä¸ä¼šç»§æ‰¿ã€‚å¦‚æœå¸Œæœ›ä½¿ç”¨åœ¨è¶…ç±»ä¸­å®šä¹‰çš„å‘½åæ„é€ å‡½æ•°æ¥åˆ›å»ºå­ç±»ï¼Œåˆ™å¿…é¡»åœ¨å­ç±»ä¸­å®ç°è¯¥æ„é€ å‡½æ•°ã€‚



#### 5.2.2 éé»˜è®¤çš„è¶…ç±»æ„é€ å‡½æ•°

**é»˜è®¤æƒ…å†µä¸‹ï¼Œå­ç±»ä¸­çš„æ„é€ å‡½æ•°è°ƒç”¨çˆ¶ç±»çš„æœªå‘½åçš„æ— å‚æ•°æ„é€ å‡½æ•°ã€‚çˆ¶ç±»çš„æ„é€ å‡½æ•°åœ¨æ„é€ å‡½æ•°ä½“çš„å¼€å§‹å¤„è¢«è°ƒç”¨ã€‚**å¦‚æœç±»ä¸­æœ‰ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼Œåˆå§‹åŒ–åˆ—è¡¨å°†åœ¨è°ƒç”¨è¶…ç±»ä¹‹å‰æ‰§è¡Œã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ‰§è¡Œé¡ºåºå¦‚ä¸‹:

- åˆå§‹åŒ–åˆ—è¡¨
- è¶…ç±»ä¸­çš„æ— å‚æ•°æ„é€ å‡½æ•°
- main ç±»ä¸­çš„æ— å‚æ•°æ„é€ å‡½æ•°

å¦‚æœè¶…ç±»æ²¡æœ‰æœªå‘½åçš„æ— å‚æ•°æ„é€ å‡½æ•°ï¼Œåˆ™å¿…é¡»æ‰‹åŠ¨è°ƒç”¨è¶…ç±»ä¸­çš„ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚åœ¨å†’å·ï¼ˆ:ï¼‰ä¹‹åï¼Œåœ¨æ„é€ å‡½æ•°ä½“ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¹‹å‰æŒ‡å®šè¶…ç±»æ„é€ å‡½æ•°ã€‚

**æ³¨ï¼š**dart ä¸­çš„è¶…ç±»è°ƒç”¨å’Œå…¶å®ƒçš„è¯­è¨€æœ‰æ‰€åŒºåˆ«ï¼Œä¸èƒ½åœ¨æ„é€ å‡½æ•°å†…éƒ¨ä½¿ç”¨`super()`æ¥è°ƒç”¨ï¼Œè€Œæ˜¯è¦åœ¨å‡½æ•°ä½“ä¹‹å‰å°±æŒ‡å®šå¥½è¦è¿è¡Œçš„è¶…ç±»å‡½æ•°ã€‚åŒæ—¶ï¼Œå­ç±»çš„è¶…ç±»ä¸çˆ¶ç±»çš„è¶…ç±»æ˜¯å¯ä»¥ä¸ä¸€è‡´çš„ï¼ˆæŒ‰ç…§æ­£å¸¸çš„ä»£ç é£æ ¼ï¼Œæˆ‘ä»¬åº”è¯¥å°†å…¶è®¾ç½®ä¸ºåŒåçš„ï¼Œè¿™æ ·æ‰å¥½ç®¡ç†ï¼‰ï¼Œä½†æ˜¯å¦‚æœçˆ¶ç±»è‡ªå®šä¹‰äº†æ„é€ å‡½æ•°ï¼Œå­ç±»å¿…é¡»è¦è°ƒç”¨çˆ¶ç±»çš„å…¶ä¸­ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚

```dart
class Person {
  String firstName;

  Person.fromJson(Map data) {
    print('in Person');
  }
}

class Employee extends Person {
  // Person does not have a default constructor;
  // you must call super.fromJson(data).
  Employee.fromJson(Map data) : super.fromJson(data) { // è¿™é‡Œå­ç±»å¯ä»¥è°ƒç”¨ä»»æ„çš„çˆ¶ç±»æ‹¥æœ‰çš„æ„é€ å‡½æ•°
    print('in Employee');
  }
}

main() {
  var emp = new Employee.fromJson({});

  // Prints:
  // in Person
  // in Employee
  if (emp is Person) {
    // Type check
    emp.firstName = 'Bob';
  }
  (emp as Person).firstName = 'Bob';
}

/// ç»“æœè¾“å‡ºä¸º
/*
in Person
in Employee
*/
```

**å› ä¸ºçˆ¶ç±»æ„é€ å‡½æ•°çš„å‚æ•°æ˜¯åœ¨è°ƒç”¨æ„é€ å‡½æ•°ä¹‹å‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å‚æ•°å¯ä»¥æ˜¯è¡¨è¾¾å¼**ï¼Œæ¯”å¦‚å‡½æ•°è°ƒç”¨ï¼š

```dart
class Employee extends Person {
  Employee() : super.fromJson(getDefaultData());
  // Â·Â·Â·
}
```

**æ³¨æ„ï¼š**åœ¨è¶…ç±»çš„æ„é€ å‡½æ•°çš„å‚æ•°ä¸­ä¸èƒ½ä½¿ç”¨`this`å…³é”®å­—ã€‚



#### 5.2.3 åˆå§‹åŒ–åˆ—è¡¨ 

**é™¤äº†è°ƒç”¨è¶…ç±»æ„é€ å‡½æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸»ä½“è¿è¡Œä¹‹å‰åˆå§‹åŒ–å®ä¾‹å˜é‡ã€‚åˆå§‹å€¼è®¾å®šé¡¹ç”¨é€—å·åˆ†å¼€ã€‚**

```dart
// Initializer list sets instance variables before
// the constructor body runs.
Point.fromJson(Map<String, num> json)
    : x = json['x'],
      y = json['y'] {
  print('In Point.fromJson(): ($x, $y)');
}
```

**æ³¨æ„ï¼š**åˆå§‹åŒ–å™¨çš„å³è¾¹éƒ¨åˆ†ä¸­æ— æ³•è®¿é—®`this`å…³é”®å­—ï¼ˆå·¦è¾¹æ˜¯å¯ä»¥çš„ï¼Œå¦‚æœæ²¡æœ‰å‘½åå†²çªä¹Ÿå¯ä»¥çœç•¥ thisï¼‰,æ‰€ä»¥å³è¾¹çš„å˜é‡éƒ½ä¼šä½¿ç”¨å®ä¾‹æ—¶ä¼ å…¥çš„å˜é‡ã€‚

åœ¨å¼€å‘æœŸé—´ï¼Œå¯ä»¥é€šè¿‡åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­ä½¿ç”¨ assert æ¥éªŒè¯è¾“å…¥ã€‚

```dart
Point.withAssert(this.x, this.y) : assert(x >= 0) {
  print('In Point.withAssert(): ($x, $y)');
}
```

åˆå§‹åŒ–åˆ—è¡¨åœ¨è®¾ç½®`final`å­—æ®µæ—¶å¾ˆæ–¹ä¾¿ã€‚ä¸‹é¢çš„ç¤ºä¾‹åˆå§‹åŒ–åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„ä¸‰ä¸ª`final`å­—æ®µï¼š

```dart
import 'dart:math';

class Point {
  final num x;
  final num y;
  final num distanceFromOrigin;

  Point(x, y)
      : x = x,
        y = y,
        distanceFromOrigin = sqrt(x * x + y * y);
}

main() {
  var p = new Point(2, 3);
  print(p.distanceFromOrigin);
}

/// è¿è¡Œç»“æœ
/*
3.605551275463989
*/
```

**æ³¨æ„ï¼š**å½“åˆå§‹åŒ–åˆ—è¡¨å’Œè¶…ç±»çš„æ„é€ å‡½æ•°ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œè¶…ç±»çš„æ„é€ å‡½æ•°è¦å†™åœ¨æœ€åé¢ï¼Œå‰é¢ä¹Ÿæ˜¯ç”¨é€—å·éš”å¼€ã€‚

```dart
class Animal {
  int x;
  int y;
  Animal(this.x, this.y);
}

class Dog extends Animal {
  int z;
  Dog(int x, int y, int z)
      : this.z = z,
        super(x, y);
}

void main() {
  var dog = new Dog(1, 2, 3);
  print(dog.x); // 1
  print(dog.y); // 2
  print(dog.z); // 3
}
```



#### 5.2.4 é‡å®šå‘æ„é€ å‡½æ•°

æœ‰æ—¶ï¼Œæ„é€ å‡½æ•°çš„å”¯ä¸€ç›®çš„æ˜¯é‡å®šå‘åˆ°åŒä¸€ä¸ªç±»ä¸­çš„å¦ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚é‡å®šå‘æ„é€ å‡½æ•°çš„ä¸»ä½“ä¸ºç©ºï¼Œæ„é€ å‡½æ•°è°ƒç”¨å‡ºç°åœ¨å†’å·ï¼ˆ:ï¼‰ä¹‹åã€‚

```dart
class Point {
  num x, y;

  // The main constructor for this class.
  Point(this.x, this.y);

  // Delegates to the main constructor.
  Point.alongXAxis(num x) : this(x, 0);
}
```

**æ³¨æ„ï¼š**é‡å®šå‘çš„æ„é€ å‡½æ•°ä¸èƒ½åˆå§‹åŒ–åˆ—è¡¨å’Œè°ƒç”¨è¶…ç±»æ„é€ å‡½æ•°ï¼Œå†’å·ï¼ˆ:ï¼‰ä¹‹ååªèƒ½æ˜¯é‡å®šå‘æ–¹æ³•ã€‚



#### 5.2.5 å¸¸é‡æ„é€ å‡½æ•°

**å¦‚æœç±»ç”Ÿæˆçš„å¯¹è±¡ä¸ä¼šæ”¹å˜ï¼Œå¯ä»¥ä½¿è¿™äº›å¯¹è±¡æˆä¸ºç¼–è¯‘æ—¶å¸¸é‡ã€‚**ä¸ºæ­¤ï¼Œå®šä¹‰ä¸€ä¸ª const æ„é€ å‡½æ•°ï¼Œå¹¶ç¡®ä¿æ‰€æœ‰å®ä¾‹å˜é‡éƒ½æ˜¯ final çš„ã€‚

**è¿™æ ·çš„æ„é€ å‡½æ•°å®ä¾‹å‡ºçš„å¯¹è±¡å±æ€§æ˜¯ä¸èƒ½é€šè¿‡`x.xx = xx`æ¥æ”¹å˜çš„ï¼Œæ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶å°±åˆ›å»ºå¥½çš„å¸¸é‡ã€‚åŒæ—¶ä¼ å…¥ç›¸åŒå€¼å¾—å®ä¾‹éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹**

```dart
class ImmutablePoint {
  static final ImmutablePoint origin =
      const ImmutablePoint(0, 0);

  final num x, y;

  const ImmutablePoint(this.x, this.y);
}
void main() {
  var a = const ImmutablePoint(1, 1);
  var b = const ImmutablePoint(1, 1);

  print(a == b); // true
}
```

**æ³¨æ„ï¼š**å¸¸é‡æ„é€ å‡½æ•°ä¸èƒ½å¤Ÿæœ‰å‡½æ•°ä½“ï¼Œä¹Ÿå°±æ˜¯åé¢çš„`{}`ã€‚



#### 5.2.6 å·¥å‚æ„é€ å‡½æ•°

åœ¨å®ç°æ„é€ å‡½æ•°æ—¶ä½¿ç”¨`factory`å…³é”®å­—ï¼Œè¯¥æ„é€ å‡½æ•°å¹¶ä¸æ€»æ˜¯åˆ›å»ºç±»çš„æ–°å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œå·¥å‚æ„é€ å‡½æ•°å¯ä»¥ä»ç¼“å­˜è¿”å›å®ä¾‹ï¼Œä¹Ÿå¯ä»¥è¿”å›å­ç±»å‹çš„å®ä¾‹ã€‚

ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºå·¥å‚æ„é€ å‡½æ•°ä»ç¼“å­˜è¿”å›å¯¹è±¡ï¼š

```dart
class Logger {
  final String name;
  bool mute = false;

  // _cache is library-private, thanks to
  // the _ in front of its name.
  static final Map<String, Logger> _cache =
      <String, Logger>{};

  factory Logger(String name) {
    if (_cache.containsKey(name)) {
      return _cache[name];
    } else {
      final logger = Logger._internal(name);
      _cache[name] = logger;
      return logger;
    }
  }

  Logger._internal(this.name);

  void log(String msg) {
    if (!mute) print(msg);
  }
}
```

è°ƒç”¨å·¥å‚æ„é€ å‡½æ•°ï¼Œå°±åƒè°ƒç”¨å…¶ä»–æ„é€ å‡½æ•°ä¸€æ ·ï¼š

```dart
var logger = Logger('UI');
logger.log('Button clicked');
```

**æ³¨æ„ï¼š**

- å·¥å‚æ„é€ å‡½æ•°ä¸èƒ½è®¿é—® this å…³é”®å­—ï¼Œæ‰€ä»¥ä½¿ç”¨å˜é‡é»˜è®¤ä¼šä½¿ç”¨ç±»çš„é™æ€å±æ€§ã€‚

- å·¥å‚å‡½æ•°ä¸­ç¼“å­˜çš„å®ä¾‹éƒ½ä¼šæ˜¯åŒä¸€ä¸ªï¼Œç±»ä¼¼å¸¸é‡æ„é€ å‡½æ•°ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚

  ```dart
  var logger = Logger('UI');
  var logger1 = Logger('UI');
  print(logger == logger1); // true
  ```



### 5.3 æ–¹æ³•

#### 5.3.1 å®ä¾‹æ–¹æ³•

å¯¹è±¡ä¸Šçš„å®ä¾‹æ–¹æ³•å¯ä»¥è®¿é—®å®ä¾‹å˜é‡ã€‚ä¸‹é¢ç¤ºä¾‹ä¸­çš„`distanceTo()`æ–¹æ³•æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•çš„ç¤ºä¾‹ï¼š

```dart
import 'dart:math';

class Point {
  num x, y;

  Point(this.x, this.y);

  num distanceTo(Point other) {
    var dx = x - other.x;
    var dy = y - other.y;
    return sqrt(dx * dx + dy * dy);
  }
}
```



#### 5.3.2 getter å’Œ setter æ–¹æ³•

getter å’Œ setter æ˜¯å¯¹å¯¹è±¡å±æ€§çš„è¯»å†™è®¿é—®çš„ç‰¹æ®Šæ–¹æ³•ã€‚ä»å‰é¢æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ¯ä¸ªå®ä¾‹å˜é‡éƒ½æœ‰ä¸€ä¸ªéšå¼çš„ getterï¼Œå¦‚æœéœ€è¦çš„è¯è¿˜å¯ä»¥åŠ ä¸Šä¸€ä¸ª setterã€‚ä½¿ç”¨`get`å’Œ`set`å…³é”®å­—æ¥å®ç° getter å’Œ setter æ–¹æ³•å¯ä»¥æ¥è¯»å†™å…¶ä»–å±æ€§ï¼š

```dart
class Rectangle {
  num left, top, width, height;

  Rectangle(this.left, this.top, this.width, this.height);

  // Define two calculated properties: right and bottom.
  num get right => left + width;
  void set right(num value) => left = value - width;
  num get bottom => top + height;
  set bottom(num value) => top = value - height;
  
  // éç®­å¤´å‡½æ•°å†™æ³•ï¼Œgetterå‡½æ•°åé¢æ²¡æœ‰()ï¼Œä¸èƒ½ä¼ å…¥å‚æ•°
  num get area {
    return this.height * this.width;
  }
  void set areaHeight(num value) {
    this.height = value;
  }
}

test() => {
      if (true) {print("success")}
    };
void main() {
  var rect = Rectangle(3, 4, 20, 15);
  assert(rect.left == 3);
  rect.right = 12;
  assert(rect.left == -8);
}
```

**æ³¨æ„ï¼š**

- getter ä¸ setter å‡½æ•°åœ¨ä½¿ç”¨æ—¶å°±å¦‚åŒå®ä¾‹çš„æ™®é€šå±æ€§çš„èµ‹å€¼ä¸è¯»å–ä¸€æ ·ä½¿ç”¨ï¼Œè€Œä¸æ˜¯åƒå‡½æ•°ä¸€æ ·ä½¿ç”¨ã€‚

- getter å‡½æ•°ä¸å…¶ä»–å‡½æ•°æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºä¸èƒ½ä¼ å…¥å‚æ•°ï¼Œæ‰€æœ‰ dart åœ¨è¯­æ³•ä¸­éƒ½æ²¡æœ‰`()`ç»™æˆ‘ä»¬ä½¿ç”¨ã€‚

- setter çš„å‡½æ•°ç±»å‹åªèƒ½ä¸å†™æˆ–è€…æ˜¯ void ç±»å‹ï¼ŒåŒæ—¶è™½ç„¶æ˜¯ void ç±»å‹ä½†æ˜¯å’Œæ™®é€šçš„å˜é‡èµ‹å€¼ä¸€æ ·é»˜è®¤è¿˜æ˜¯æœ‰èµ‹å€¼çš„å˜é‡ä½œä¸ºè¿”å›å€¼çš„ã€‚

  ```dart
  // å¦‚æœæ˜¯å…¶ä»–è¿”å›å€¼æ˜¯voidçš„å‡½æ•°ä½¿ç”¨å‡½æ•°è¿”å›å€¼æ˜¯ä¼šæŠ¥é”™çš„
  print(rect.left = 3); // 3
  ```

- è¯¸å¦‚`increment(++)`ä¹‹ç±»çš„æ“ä½œç¬¦ä»¥é¢„æœŸçš„æ–¹å¼å·¥ä½œï¼Œæ— è®º getter æ˜¯å¦è¢«æ˜¾å¼å®šä¹‰ã€‚ä¸ºäº†é¿å…ä»»ä½•æ„å¤–çš„å‰¯ä½œç”¨ï¼Œæ“ä½œç¬¦åªè°ƒç”¨ getter ä¸€æ¬¡ï¼Œå°†å…¶å€¼ä¿å­˜åœ¨ä¸€ä¸ªä¸´æ—¶å˜é‡ä¸­ã€‚



#### 5.3.3 æŠ½è±¡æ–¹æ³•ä¸æŠ½è±¡ç±»

**å®ä¾‹æ–¹æ³•ã€getter å’Œ setter æ–¹æ³•éƒ½å¯ä»¥æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œåªå®šä¹‰ä¸€ä¸ªæ¥å£ä½†æ˜¯å°†å…·ä½“å®ç°ç•™ç»™å…¶ä»–ç±»ï¼Œå…¶ä»–ç±»å¿…é¡»å®ç°è¯¥æŠ½è±¡æ¥å£ã€‚æŠ½è±¡æ–¹æ³•åªèƒ½å­˜åœ¨äºæŠ½è±¡ç±»ä¸­ï¼ŒæŠ½è±¡æ–¹æ³•æ˜¯æ²¡æœ‰æ–¹æ³•ä½“`{}`çš„ã€‚è°ƒç”¨æŠ½è±¡æ–¹æ³•ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ã€‚**

```dart
abstract class Doer {
  // Define instance variables and methods...

  void doSomething(); // Define an abstract method.
}

class EffectiveDoer extends Doer {
  void doSomething() {
    // Provide an implementation, so the method is not abstract here...
  }
}
```

**æ³¨æ„ï¼š**dart ä¸­å®ç°æŠ½è±¡æ–¹æ³•ç›´æ¥åœ¨ç±»åå‰é¢åŠ ä¸Š abstract å…³é”®å­—ä½¿ç±»å˜æˆæŠ½è±¡ç±»å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦åœ¨ç‰¹å®šçš„æ–¹æ³•å‰é¢åŠ ä¸Š abstract å…³é”®å­—ï¼Œ**æ²¡æœ‰æ–¹æ³•ä½“çš„æ–¹æ³• dart ä¼šè‡ªåŠ¨å°†å…¶çœ‹åšæŠ½è±¡æ–¹æ³•**ã€‚



### 5.4 ç»§æ‰¿

ä¸ Java å’Œ JavaScript ä¸­ä¸€è‡´ï¼Œä½¿ç”¨`extend`åˆ›å»ºå­ç±»ï¼Œä½¿ç”¨`super`å¼•ç”¨è¶…ç±»ï¼š

```dart
class Television {
  void turnOn() {
    _illuminateDisplay();
    _activateIrSensor();
  }
  // Â·Â·Â·
}

class SmartTelevision extends Television {
  void turnOn() {
    super.turnOn();
    _bootNetworkInterface();
    _initializeMemory();
    _upgradeApps();
  }
  // Â·Â·Â·
```



### 5.5 é‡å†™å±æ€§å’Œæ–¹æ³•

#### 5.5.1 é‡å†™ç±»çš„æˆå‘˜

å­ç±»å¯ä»¥è¦†ç›–å®ä¾‹æ–¹æ³•ã€getter å’Œ setterã€‚å¯ä»¥ä½¿ç”¨`@override`æ³¨é‡Šæ¥æŒ‡ç¤ºé‡å†™äº†æŸä¸ªæˆå‘˜æ–¹æ³•ï¼š

```dart
class SmartTelevision extends Television {
  @override
  void turnOn() {...}
  // Â·Â·Â·
}
```

**æ³¨ï¼š**è¦åœ¨ç±»å‹å®‰å…¨çš„ä»£ç ä¸­ç¼©å°æ–¹æ³•å‚æ•°æˆ–å®ä¾‹å˜é‡çš„ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨`covariant`å…³é”®å­—ã€‚



#### 5.5.2 é‡å†™æ“ä½œç¬¦

å¯ä»¥é‡å†™ä¸‹è¡¨ä¸­æ˜¾ç¤ºçš„æ“ä½œç¬¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®šä¹‰ä¸€ä¸ª`Vector`ç±»ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ª`+`æ–¹æ³•æ¥è®©ä¸¤ä¸ªå‘é‡ç›¸åŠ ã€‚

| <    | +    | \|   | []   |
| :--- | :--- | :--- | :--- |
| >    | /    | ^    | []=  |
| <=   | ~/   | &    | ~    |
| >=   | *    | <<   | ==   |
| -    | %    | >>   |      |

ä¸‹ä¾‹åœ¨ç±»ä¸­é‡å†™äº†`+`å’Œ`-`æ“ä½œç¬¦ï¼š

```dart
class Vector {
  final int x, y;

  Vector(this.x, this.y);

  Vector operator +(Vector v) => Vector(x + v.x, y + v.y);
  Vector operator -(Vector v) => Vector(x - v.x, y - v.y);

  // Operator == and hashCode not shown. For details, see note below.
  // Â·Â·Â·
}

void main() {
  final v = Vector(2, 3);
  final w = Vector(2, 2);

  assert(v + w == Vector(4, 5));
  assert(v - w == Vector(0, 1));
}
```

**æ³¨æ„ï¼š**å¦‚æœé‡å†™`==`ï¼Œè¿˜åº”è¯¥é‡å†™å¯¹è±¡çš„`hashCode getter`ã€‚å…·ä½“ä¸å†ä»‹ç»ã€‚



#### 5.5.3 noSuchMethod()

**å¯ä»¥é‡å†™`noSuchMethod()`æ–¹æ³•æ¥å¤„ç†ç¨‹åºè®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æˆ–è€…æˆå‘˜å˜é‡ï¼š**

```dart
class A {
  // Unless you override noSuchMethod, using a
  // non-existent member results in a NoSuchMethodError.
  @override
  void noSuchMethod(Invocation invocation) {
    print('You tried to use a non-existent member: ' +
        '${invocation.memberName}');
  }
}
```

**ä¸èƒ½è°ƒç”¨æœªå®ç°çš„æ–¹æ³•ï¼Œé™¤éä¸‹åˆ—ä»»ä½•ä¸€ä¸ªæ˜¯æ­£ç¡®çš„ï¼š**

- è¢«è°ƒç”¨è€…æœ‰**é™æ€æ–¹æ³•** `dynamic`
- è¢«è°ƒç”¨è€…æœ‰ä¸€ä¸ªé™æ€ç±»å‹æ¥å®šä¹‰æœªå®ç°çš„æ–¹æ³•ï¼ˆä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡æ–¹æ³•ï¼‰ï¼Œè€Œæ¥æ”¶è€…çš„åŠ¨æ€ç±»å‹æœ‰ä¸€ä¸ª`noSuchMethod()`çš„å®ç°ï¼Œå®ƒä¸ç±»å¯¹è±¡ä¸­çš„æ–¹æ³•ä¸åŒã€‚



### 5.6 ç±»ï¼ˆé™æ€ï¼‰å˜é‡å’Œæ–¹æ³•

**ä½¿ç”¨`static`å…³é”®å­—å®ç°ç±»èŒƒå›´çš„å˜é‡å’Œæ–¹æ³•ã€‚**

#### 5.6.1 é™æ€å˜é‡

é™æ€å˜é‡ï¼ˆç±»å˜é‡ï¼‰å¯¹äºç±»èŒƒå›´å†…çš„çŠ¶æ€å’Œå¸¸é‡æ˜¯æœ‰ç”¨çš„ï¼š

```dart
class Queue {
  static const initialCapacity = 16;
  // Â·Â·Â·
}

void main() {
  assert(Queue.initialCapacity == 16);
}
```

**æ³¨ï¼š**é™æ€å˜é‡åœ¨ä½¿ç”¨ä¹‹å‰ä¸ä¼šåˆå§‹åŒ–ã€‚



#### 5.6.2 é™æ€æ–¹æ³•

é™æ€æ–¹æ³•ï¼ˆç±»æ–¹æ³•ï¼‰ä¸å¯¹å®ä¾‹è¿›è¡Œæ“ä½œï¼Œå› æ­¤æ— æ³•è®¿é—®è¯¥å®ä¾‹ã€‚ä¾‹å¦‚ï¼š

```dart
import 'dart:math';

class Point {
  num x, y;
  Point(this.x, this.y);

  static num distanceBetween(Point a, Point b) {
    var dx = a.x - b.x;
    var dy = a.y - b.y;
    return sqrt(dx * dx + dy * dy);
  }
}

void main() {
  var a = Point(2, 2);
  var b = Point(4, 4);
  var distance = Point.distanceBetween(a, b);
  assert(2.8 < distance && distance < 2.9);
  print(distance);
}
```

å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•ä½œä¸ºç¼–è¯‘æ—¶å¸¸é‡ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å°†é™æ€æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¸¸é‡æ„é€ å‡½æ•°ã€‚



### 5.7 ç§æœ‰æˆå‘˜

åœ¨ dart ä¸­çš„ç±»å®šä¹‰ç§æœ‰æˆå‘˜ä¸åƒ Java é‚£æ ·æœ‰å…¬å¼€ã€ä¿æŠ¤å’Œç§æœ‰çš„å…³é”®å­—ã€‚å¦‚æœæ ‡è¯†ç¬¦ä»¥ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰å¼€å¤´ï¼Œåˆ™è¯¥æ ‡è¯†ç¬¦å¯¹å…¶åº“æ˜¯ç§æœ‰çš„ã€‚

**æ³¨æ„ï¼š**ç§æœ‰çš„ç±»æˆå‘˜åœ¨åŒä¸€ä¸ªåº“ä¸­æ˜¯æ— æ•ˆçš„ï¼Œå¿…é¡»è¦åœ¨ä¸åŒçš„åº“ä¸­è¢«å¼•å…¥æ‰èƒ½å¤Ÿä½œä¸ºç§æœ‰æˆå‘˜ã€‚åœ¨åŒä¸€ä¸ªåº“ä¸­ä½¿ç”¨ä¼šè¢«å½“åšæ˜¯ä¸€ä¸ªæ™®é€šçš„æˆå‘˜å˜é‡ã€‚

```dart
import 'B.dart';

void main() {
  var b = new B();
  b.run();
  b._run(); // Error
}
```



### 5.8 éšå¼æ¥å£

dart ä¸­æœ‰æ¥å£çš„æ¦‚å¿µï¼Œä½†æ˜¯æ²¡æœ‰ä¸“é—¨å•ç‹¬å®šä¹‰æ¥å£çš„å…³é”®å­—`interface`ï¼Œåœ¨ dart ä¸­çš„æ¥å£ä½¿ç”¨ç±»æ¥è¿›è¡Œä»£æ›¿ï¼ˆä¸€èˆ¬ä½¿ç”¨æŠ½è±¡ç±»ï¼‰ï¼Œæ¯ä¸ªç±»éƒ½éšå¼åœ°å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£åŒ…å«ç±»çš„æ‰€æœ‰å®ä¾‹æˆå‘˜åŠå…¶å®ç°çš„ä»»ä½•æ¥å£ã€‚

```dart
// A person. The implicit interface contains greet().
class Person {
  // In the interface, but visible only in this library.
  final _name;

  // Not in the interface, since this is a constructor.
  Person(this._name);

  // In the interface.
  String greet(String who) => 'Hello, $who. I am $_name.';
}

// An implementation of the Person interface.
class Impostor implements Person {
  get _name => '';

  String greet(String who) => 'Hi $who. Do you know who I am?';
}

String greetBob(Person person) => person.greet('Bob');

void main() {
  print(greetBob(Person('Kathy')));
  print(greetBob(Impostor()));
}
```

**ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼š**

```dart
class Point implements Comparable, Location {...}
```



### 5.9 å¯è°ƒç”¨çš„ç±»

å®ç°`call()`æ–¹æ³•å¯ä»¥è®© dart ç±»çš„å®ä¾‹åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ï¼Œç›¸å½“äºå®ä¾‹åŒ–è¿”å›äº†ä¸€ä¸ªå‡½æ•°å¯¹è±¡ã€‚

åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ`WannabeFunction`ç±»å®šä¹‰äº†ä¸€ä¸ª`call()`å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸‰ä¸ªå­—ç¬¦ä¸²å¹¶å°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²ç”¨ç©ºæ ¼åˆ†éš”ï¼Œå¹¶åœ¨ç»“å°¾åŠ ä¸€ä¸ªæ„Ÿå¹å·ã€‚

```dart
class WannabeFunction {
  call(String a, String b, String c) => '$a $b $c!';
}

main() {
  var wf = new WannabeFunction();
  var out = wf("Hi", "there,", "gang");
  print('$out');
}

/// æ‰§è¡Œç»“æœ
/*
Hi there, gang!
*/
```



### 5.10 mixins

**mixins æ˜¯åœ¨å¤šä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­é‡ç”¨ç±»ä»£ç çš„ä¸€ç§æ–¹å¼ã€‚mixins çš„ä¸­æ–‡æ„æ€æ˜¯æ··å…¥ï¼Œå°±æ˜¯åœ¨ç±»ä¸­æ··å…¥å…¶ä»–åŠŸèƒ½ï¼Œåœ¨ dart ä¸­å¯ä»¥ä½¿ç”¨ mixins å®ç°ç±»ä¼¼å¤šç»§æ‰¿çš„åŠŸèƒ½ã€‚**

è¦ä½¿ç”¨ mixinï¼Œéœ€è¦åœ¨ with å…³é”®å­—åé¢åŠ ä¸Šä¸€ä¸ªæˆ–å¤šä¸ª mixin åç§°ã€‚ä¸‹é¢çš„ä¾‹å­æ˜¾ç¤ºäº†ä¸¤ä¸ªä½¿ç”¨ mixin çš„ç±»ï¼š

```dart
class Musician extends Performer with Musical {
  // Â·Â·Â·
}

// å½“ç»§æ‰¿å’Œmixinsç”¨åœ¨ä¸€èµ·æ˜¯extendså…³é”®å­—åº”è¯¥åœ¨withä¹‹å‰
class Maestro extends Person
    with Musical, Aggressive, Demented {
  Maestro(String maestroName) {
    name = maestroName;
    canConduct = true;
  }
}
```

**å› ä¸º mixins ä½¿ç”¨çš„æ¡ä»¶ï¼Œéšç€ dart ç‰ˆæœ¬ä¸€ç›´åœ¨å˜ï¼Œè¿™é‡Œè¯´æ˜ä¸€ä¸‹ dart 2.x ä¸­çš„ä½¿ç”¨æ¡ä»¶ï¼š**

- ä½œä¸º mixins çš„ç±»åªèƒ½ç»§æ‰¿ Object ç±»ï¼ˆä¹Ÿå°±æ˜¯åˆ›å»ºçš„æ—¶å€™ä¸èƒ½ä½¿ç”¨ extends å…³é”®å­—ï¼‰ï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–ç±»ã€‚
- ä½œä¸º mixins çš„ç±»ä¸èƒ½æœ‰æ„é€ å‡½æ•°ã€‚
- ä¸€ä¸ªç±»å¯ä»¥ mixins å¤šä¸ª mixins ç±»ã€‚
- mixins ç»ä¸æ˜¯ç»§æ‰¿ï¼Œä¹Ÿä¸æ˜¯æ¥å£ï¼Œè€Œæ˜¯ä¸€ç§å…¨æ–°çš„ç‰¹æ€§ã€‚

```dart
abstract class Musical {
  bool canPlayPiano = false;
  bool canCompose = false;
  bool canConduct = false;

  void entertainMe() {
    if (canPlayPiano) {
      print('Playing piano');
    } else if (canConduct) {
      print('Waving hands');
    } else {
      print('Humming to self');
    }
  }
}
```

**mixins ä½¿ç”¨æ—¶æ³¨æ„ç‚¹ï¼š**

- å½“ç»§æ‰¿çš„ç±»å’Œmixinsçš„ç±»æœ‰å±æ€§æˆ–æ–¹æ³•åå†²çªæ—¶ï¼Œåé¢åº”ç”¨çš„ç±»çš„å±æ€§æˆ–æ–¹æ³•ä¼šé¡¶æ›¿æ‰å‰é¢åº”ç”¨çš„ã€‚

- mixins åçš„ç±»å®ä¾‹çš„æˆå‘˜æ˜¯è¿ç”¨åˆ°çš„æ‰€æœ‰ç±»çš„å®ä¾‹ã€‚

  ```dart
  class Maestro extends Person
      with Musical, Aggressive, Demented {
    Maestro(String maestroName) {
      name = maestroName;
      canConduct = true;
    }
  }
  void main(){
      var m = new Maestro();
      print(m is Person); // true
      print(m is Musical); // true
      print(m is Aggressive); // true
      print(m is Demented); // true
  }
  ```



## 6.æ³›å‹

**æ³›å‹çš„ç”¨æ³•åŒ Java å’Œ TypeScript ä¸­çš„ç”¨æ³•ç±»ä¼¼ï¼Œè¿™é‡Œåªç€é‡è¯´æ˜ dart ä¸­çš„ç‰¹æ€§ã€‚**

### 6.1 ä½¿ç”¨é›†åˆå­—é¢é‡

List å’Œ map å­—é¢é‡å¯ä»¥è¢«å‚æ•°åŒ–ã€‚å‚æ•°åŒ–å­—é¢é‡å’Œå·²ç»è®¤è¯†çš„æ‰€æœ‰å­—é¢é‡ä¸€æ ·ï¼Œä»…ä»…æ˜¯åœ¨å­—é¢é‡çš„å¼€å§‹æ‹¬å·ä¹‹å‰æ·»åŠ `<type>`ï¼ˆå¯¹äº List ç±»å‹æ¥è¯´ï¼‰æˆ–è€…æ·»åŠ `<keyType, valueType>`ï¼ˆå¯¹äº map ç±»å‹æ¥è¯´ï¼‰ã€‚

```dat
var names = <String>['Seth', 'Kathy', 'Lars'];
var pages = <String, String>{
  'index.html': 'Homepage',
  'robots.txt': 'Hints for web robots',
  'humans.txt': 'We are people, not machines'
};
```



### 6.2 æ„é€ å‡½æ•°çš„å‚æ•°åŒ–ç±»å‹

è¦åœ¨ä½¿ç”¨æ„é€ å‡½æ•°æ—¶æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹ï¼Œè¯·å°†ç±»å‹æ”¾åœ¨ç±»ååé¢çš„å°–æ‹¬å·`<â€¦>`ä¸­ã€‚

```dart
var names = List<String>();
names.addAll(['Seth', 'Kathy', 'Lars']);
var nameSet = Set<String>.from(names);
```

ä¸‹é¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰æ•´æ•°é”®å’Œè§†å›¾ç±»å‹å€¼çš„mapæ˜ å°„ï¼š

```dart
var views = Map<int, View>();
```



### 6.3 æ³›å‹é›†åˆåŠå…¶åŒ…å«çš„ç±»å‹

dart é€šç”¨ç±»å‹è¢«å…·ä½“åŒ–ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åœ¨è¿è¡Œæ—¶æºå¸¦å®ƒä»¬çš„ç±»å‹ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æµ‹è¯•é›†åˆçš„ç±»å‹ï¼š

```dart
var names = List<String>();
names.addAll(['Seth', 'Kathy', 'Lars']);
print(names is List<String>); // true
```

**æ³¨æ„ï¼š**ç›¸åï¼ŒJava ä¸­çš„æ³›å‹ä½¿ç”¨æ“¦é™¤ï¼Œè¿™æ„å‘³ç€æ³›å‹ç±»å‹å‚æ•°åœ¨è¿è¡Œæ—¶è¢«åˆ é™¤ã€‚åœ¨ Java ä¸­ï¼Œå¯ä»¥æµ‹è¯•ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä½†ä¸èƒ½æµ‹è¯•å®ƒæ˜¯å¦æ˜¯ String ç±»å‹çš„åˆ—è¡¨ã€‚



### 6.4 é™åˆ¶å‚æ•°åŒ–ç±»å‹

åœ¨å®ç°æ³›å‹ç±»å‹æ—¶ï¼Œå¯èƒ½å¸Œæœ›é™åˆ¶å…¶å‚æ•°çš„ç±»å‹ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ä½¿ç”¨ extends å…³é”®å­—

```dart
class Foo<T extends SomeBaseClass> {
  // Implementation goes here...
  String toString() => "Instance of 'Foo<$T>'";
}

class Extender extends SomeBaseClass {...}
```

å¯ä»¥ä½¿ç”¨ **SomeBaseClass æˆ–å®ƒçš„ä»»ä½•å­ç±»**ä½œä¸ºæ³›å‹å‚æ•°ï¼š

```dart
var someBaseClassFoo = Foo<SomeBaseClass>();
var extenderFoo = Foo<Extender>();
```

**å½“ä¸çŸ¥é“æ³›å‹å‚æ•°æ—¶é»˜è®¤ä¼šæ˜¯ extends çš„ç±»æœ¬èº«ï¼ˆå¦åˆ™ä¼šæ˜¯ dynamicï¼‰ï¼š**

```dart
var foo = Foo();
print(foo); // Instance of 'Foo<SomeBaseClass>'
```

ä¼ å…¥å…¶ä»–çš„é extends çš„ç±»æˆ–å…¶å­ç±»æ—¶ä¼šæŠ¥é”™ï¼š

```dart
var foo = Foo<Object>(); // Error
```



### 6.5 æ³›å‹æ–¹æ³•

æœ€åˆï¼Œdart ä»…ä»…åœ¨ç±»ä¸­æ”¯æŒæ³›å‹ã€‚åæ¥ä¸€ç§ç§°ä¸ºæ³›å‹æ–¹æ³•çš„æ–°è¯­æ³•å…è®¸åœ¨æ–¹æ³•å’Œå‡½æ•°ä¸­ä½¿ç”¨ç±»å‹å‚æ•°ã€‚

```dart
T first<T>(List<T> ts) {
  // Do some initial work or error checking, then...
  T tmp = ts[0];
  // Do some additional checking or processing...
  return tmp;
}
```

ç”¨æ³•åŒ TypeScript ä¸­éå¸¸ç›¸ä¼¼ï¼Œè¿™é‡Œä¸è¿‡å¤šä»‹ç»ã€‚



## 7.åº“å’Œå¯è§æ€§

import å’Œ library æŒ‡ä»¤å¯ä»¥å¸®åŠ©åˆ›å»ºæ¨¡å—åŒ–å’Œå¯å…±äº«çš„ä»£ç åº“ã€‚åº“ä¸ä»…æä¾›apiï¼Œè€Œä¸”åŒ…å«éšç§éƒ¨åˆ†ï¼šä»¥ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰å¼€å¤´çš„æ ‡è¯†ç¬¦ä»…åœ¨åº“ä¸­å¯è§ã€‚

å¯ä»¥ä½¿ç”¨åŒ…æ¥åˆ†å‘åº“ï¼Œä¸€èˆ¬ä½¿ç”¨ç”¨ä¸åˆ°ï¼Œåœ¨è¿™é‡Œå°±ä¸åšå¤šçš„è®²è§£ã€‚

**æ³¨ï¼š**æ¯ä¸ª dart åº”ç”¨ç¨‹åºéƒ½æ˜¯ä¸€ä¸ªåº“ï¼Œå³ä½¿å®ƒä¸ä½¿ç”¨åº“æŒ‡ä»¤ã€‚



### 7.1 ä½¿ç”¨åº“

- ä½¿ç”¨`import`æ¥æŒ‡å®šå¦‚ä½•åœ¨å¦ä¸€ä¸ªåº“çš„èŒƒå›´ä¸­ä½¿ç”¨æ¥è‡ªä¸€ä¸ªåº“çš„å‘½åç©ºé—´ã€‚

  ä¾‹å¦‚ï¼Œ`dart web`åº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨`dart:html`åº“ï¼Œå®ƒä»¬å¯ä»¥è¿™æ ·å¯¼å…¥ï¼š

  ```dart
  import 'dart:html';
  ```

  å¯¼å…¥ä¸€ä¸ªåº“ä»…ä»…éœ€è¦æä¾›åº“çš„ URIã€‚å¯¹äºå†…ç½®åº“ï¼ŒURIå…·æœ‰ç‰¹å®šçš„å½¢å¼ï¼ˆdart:schemeï¼‰ã€‚å¯¹äºå…¶ä»–åº“ï¼Œå¯ä»¥ä½¿ç”¨`æ–‡ä»¶è·¯å¾„`æˆ–è€…`åŒ…:scheme`çš„å½¢å¼ã€‚`åŒ…:scheme`å½¢å¼æŒ‡å®šåŒ…ç®¡ç†å™¨ï¼ˆå¦‚ pub å·¥å…·ï¼ˆç±»ä¼¼ npmï¼‰ï¼‰æä¾›çš„åº“ã€‚ä¾‹å¦‚ï¼š

  ```dart
  import 'package:test/test.dart';
  ```

  **æ³¨æ„ï¼š**URI è¡¨ç¤ºç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ã€‚urlï¼ˆç»Ÿä¸€èµ„æºå®šä½å™¨ï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ URIã€‚

- ä½¿ç”¨`library`å®šä¹‰è¿™ä¸ªåº“çš„åå­—ï¼Œä½†åº“çš„åå­—å¹¶ä¸å½±å“å¯¼å…¥ï¼Œå› ä¸ºimportè¯­å¥ç”¨çš„æ˜¯å­—ç¬¦ä¸²Uri

  ```dart
  library person;
  ```




### 7.2 dart ä¸­çš„ä¸‰ç§åº“

åœ¨ dart ä¸­ä¸»è¦æœ‰ä¸‰ç§åº“ï¼š

- è‡ªå®šä¹‰åº“

  ```dart
  import 'lib/hello.dart';
  ```

- ç³»ç»Ÿå†…ç½®åº“

  ```dart
  import 'dart:math';
  import 'dart:io';
  import 'dart:convert';
  ```

- pub åŒ…ç®¡ç†å™¨ä¸­çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆpub ä¸­çš„åŒ…éƒ½å¯ä»¥åœ¨ [pub.dev](https://pub.dev) ä¸­æ‰¾åˆ°ï¼‰

  è¦ä¸‹è½½ç¬¬ä¸‰æ–¹åº“ï¼Œéœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª`pubspec.yaml`çš„æ–‡ä»¶ï¼Œç„¶ååœ¨å…¶ä¸­å†™å…¥å¯¹åº”çš„ä¾èµ–é¡¹ï¼Œä¿å­˜å pub ä¼šè‡ªåŠ¨å»ä¸‹è½½å¯¹åº”çš„ä¾èµ–ã€‚

#### 7.2.1 YAML æ–‡ä»¶çš„è¯­æ³•

YAML æ˜¯ä¸€ä¸ªç±»ä¼¼ XMLã€JSON çš„æ ‡è®°æ€§è¯­è¨€ã€‚YAML å¼ºè°ƒä»¥æ•°æ®ä¸ºä¸­å¿ƒï¼Œå¹¶ä¸æ˜¯ä»¥æ ‡è¯†è¯­è¨€ä¸ºé‡ç‚¹ã€‚

**è§„èŒƒï¼š**

- å¤§å°å†™æ•æ„Ÿ
- ç¼©è¿›ä»£è¡¨å±‚çº§ï¼Œä½¿ç”¨ç©ºæ ¼ï¼Œé»˜è®¤2ä¸ªç©ºæ ¼ï¼ˆflutterå·¥å…·åšäº†å¤„ç†ï¼Œtabä¹Ÿå¯ä»¥ï¼‰
- \# è¡¨ç¤ºæ³¨é‡Šå†…å®¹
-  : è¡¨ç¤ºé”®å€¼å¯¹ï¼Œæ³¨æ„åé¢è¦ç©ºæ ¼
-  {} è¡¨ç¤ºé”®å€¼è¡¨
-  \- è¡¨ç¤ºåˆ—è¡¨ï¼Œæ³¨æ„åé¢è¦ç©ºæ ¼
-  [] è¡¨ç¤ºæ•°ç»„ï¼Œæ³¨æ„æ¯é¡¹ä¹‹é—´æœ‰ç©ºæ ¼
-  ? è¡¨ç¤ºå¤æ‚çš„é”®

```yaml
# é”®å€¼å¯¹ï¼Œè¡¨ç¤ºappçš„åå­—ä¸ºflutter_app
name: flutter_app
description: A new Flutter application.
# ç¯å¢ƒï¼Œflutterçš„sdkç‰ˆæœ¬åœ¨æ­¤ä¹‹é—´
environment:
  sdk: ">=2.0.0-dev.68.0 <3.0.0"

# ä¾èµ–åº“
dependencies:
  flutter:
    sdk: flutter
  cupertino_icons: ^0.1.2
  event_bus: ^1.0.1
  shared_preferences: "^0.4.3"
  flutter_refresh: ^0.0.1

#æµ‹è¯•ç¯å¢ƒçš„ä¾èµ–åº“
dev_dependencies:
  flutter_test:
    sdk: flutter

flutter:
  #ä½¿ç”¨Materialå›¾æ ‡
  uses-material-design: true
  #assetsæ–‡ä»¶
  assets:
    - images/head.png
    - images/1.gif
  #å­—ä½“æ ·å¼
  fonts:
     #familyä¸fontsæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œåˆ—è¡¨çš„ä¸€é¡¹
     - family: Schyler
       fonts:
         - asset: fonts/Schyler-Regular.ttf
         - asset: fonts/Schyler-Italic.ttf
           style: italic
     - family: Trajan Pro
       fonts:
         - asset: fonts/TrajanPro.ttf
         - asset: fonts/TrajanPro_Bold.ttf
           weight: 700
```

**æ³¨ï¼š**`-`å¯è½¬åŒ–ä¸º`[]`ï¼Œ`:`ä¹Ÿå¯ä»¥è½¬åŒ–ä¸º`{}`ï¼Œè½¬åŒ–åç±»ä¼¼ json

```yaml
dependencies: {flutter: {sdk: flutter}, cupertino_icons: ^0.1.2, event_bus: ^1.0.1, shared_preferences: "^0.4.3", flutter_refresh: ^0.0.1}

assets: [images/head.png, images/1.gif]
```

**å¯¹äºå­—ç¬¦ä¸²ï¼š**

- å­—ç¬¦ä¸²

    ```yaml
     str0: 'æˆ‘æ˜¯å­—ç¬¦ä¸²'
     #åŒå¼•å·ä¸ä¼šå¯¹ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰
     str1: "It's a test"
     #å•å¼•å·ä¸­å•å¼•å·çš„å­—ç¬¦ï¼Œéœ€è¦è½¬ä¹‰
     str2: 'It''s a test'
     #~æ˜¯ç©ºçš„æ„æ€
     str3: ~ 
     # ä¸¤ä¸ª!è¡¨ç¤ºå¼ºåˆ¶è½¬æ¢ï¼Œ!!str è¡¨ç¤ºå¼ºåˆ¶è½¬ä¸ºstr
     str4: !!str true
     str5: ä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·å¼•èµ·æ¥ï¼Œå‰å®³ä¸
     str6: 'æœ‰ç©ºæ ¼ æˆ–è€… ç‰¹æ®Šå­—ç¬¦* å°±å¿…é¡»æ”¾åœ¨å¼•å·ä¸­äº†'
     str7: <p style="color:red">Hello world<p>
    ```

    è½¬æ¢ä¸º json

    ```json
    { 
        str0: 'æˆ‘æ˜¯å­—ç¬¦ä¸²',
        str1: 'It\'s a test',
        str2: 'It\'s a test',
        str3: null,
        str4: 'true',
        str5: 'ä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·å¼•èµ·æ¥ï¼Œå‰å®³ä¸',
        str6: 'æœ‰ç©ºæ ¼ æˆ–è€… ç‰¹æ®Šå­—ç¬¦* å°±å¿…é¡»æ”¾åœ¨å¼•å·ä¸­äº†',
        str7: '<p style="color:red">Hello world<p>' 
    }
    ```

- æ¢è¡Œ

  ```yaml
   str8: #æ¯è¡Œç”¨ç©ºæ ¼ä»£æ›¿æ¢è¡Œç¬¦ï¼Œæ¯è¡Œè¡Œå°¾ç©ºæ ¼æ— æ•ˆ
    ç¬¬ä¸€è¡Œ            
    ç¬¬äºŒè¡Œ       
    ç¬¬ä¸‰è¡Œ     
   str9: | #æ¯è¡Œéƒ½æœ‰æ¢è¡Œç¬¦
    ç¬¬ä¸€è¡Œ    
    ç¬¬äºŒè¡Œ   
    ç¬¬ä¸‰è¡Œ   
   str10: > #æœ«å°¾æœ‰æ¢è¡Œç¬¦ï¼Œä¸­é—´ç”¨ç©ºæ ¼ä»£æ›¿æ¢è¡Œç¬¦
    ç¬¬ä¸€è¡Œ   
    ç¬¬äºŒè¡Œ    
    ç¬¬ä¸‰è¡Œ  
   str11: |- #æœ«å°¾å»é™¤æ¢è¡Œç¬¦
    ç¬¬ä¸€è¡Œ 
    ç¬¬äºŒè¡Œ   
    ç¬¬ä¸‰è¡Œ      
   str12: |+ #æœ«å°¾æ·»åŠ æ¢è¡Œç¬¦
    ç¬¬ä¸€è¡Œ  
    ç¬¬äºŒè¡Œ   
    ç¬¬ä¸‰è¡Œ   
  ```

  è½¬æ¢ä¸º json

  ```json
  { 
      str8: 'ç¬¬ä¸€è¡Œ ç¬¬äºŒè¡Œ ç¬¬ä¸‰è¡Œ',
      str9: 'ç¬¬ä¸€è¡Œ    \nç¬¬äºŒè¡Œ   \nç¬¬ä¸‰è¡Œ   \n',
      str10: 'ç¬¬ä¸€è¡Œ    ç¬¬äºŒè¡Œ     ç¬¬ä¸‰è¡Œ  \n',
      str11: 'ç¬¬ä¸€è¡Œ \nç¬¬äºŒè¡Œ   \nç¬¬ä¸‰è¡Œ       ',
      str12: 'ç¬¬ä¸€è¡Œ  \nç¬¬äºŒè¡Œ   \nç¬¬ä¸‰è¡Œ   \n' 
  }
  ```
  




### 7.3 æŒ‡å®šä¸€ä¸ªåº“å‰ç¼€

å¦‚æœå¯¼å…¥ä¸¤ä¸ªå…·æœ‰å†²çªæ ‡è¯†ç¬¦çš„åº“ï¼Œé‚£ä¹ˆå¯ä»¥ä¸ºä¸€ä¸ªæˆ–ä¸¤ä¸ªåº“æŒ‡å®šä¸€ä¸ªå‰ç¼€ï¼ˆå‘½åç©ºé—´ï¼‰ã€‚

```dart
import 'package:lib1/lib1.dart';
import 'package:lib2/lib2.dart' as lib2;

// Uses Element from lib1.
Element element1 = Element();

// Uses Element from lib2.
lib2.Element element2 = lib2.Element();
```



### 7.4 åº“çš„å¯è§æ€§

å¦‚æœåªæƒ³ä½¿ç”¨åº“çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥æœ‰é€‰æ‹©åœ°å¯¼å…¥åº“ï¼Œè¿™ä¹Ÿæ˜¯åº“çš„å¯è§æ€§ã€‚

æœ‰ä¸¤ç§å…³é”®å­—æ¥è¡¨ç¤ºéœ€è¦ä½¿ç”¨çš„å†…å®¹ï¼š

- **show**ï¼šå¯¼å…¥çš„åº“åªèƒ½ä½¿ç”¨ show åé¢çš„å˜é‡ã€‚
- **hide**ï¼šå¯¼å…¥çš„åº“ä¸èƒ½ä½¿ç”¨ hide åé¢çš„å˜é‡ã€‚

```dart
// Import only foo.
import 'package:lib1/lib1.dart' show foo;

// Import all names EXCEPT foo.
import 'package:lib2/lib2.dart' hide foo;
```



### 7.5 æ‡’åŠ è½½åº“

**å»¶è¿ŸåŠ è½½ï¼ˆä¹Ÿç§°ä¸ºæ‡’åŠ è½½ï¼‰å…è®¸åº”ç”¨ç¨‹åºåœ¨éœ€è¦æ—¶æŒ‰éœ€åŠ è½½åº“ã€‚**

ä»¥ä¸‹æ˜¯ä¸€äº›å¯èƒ½ä½¿ç”¨å»¶è¿ŸåŠ è½½çš„æƒ…å†µï¼š

- å‡å°‘åº”ç”¨ç¨‹åºçš„åˆå§‹å¯åŠ¨æ—¶é—´ã€‚
- ä¾‹å¦‚ï¼Œè¦æ‰§è¡ŒA/Bæµ‹è¯•â€”â€”å°è¯•ç®—æ³•çš„å…¶ä»–å®ç°ã€‚
- åŠ è½½å¾ˆå°‘ä½¿ç”¨çš„åŠŸèƒ½ï¼Œå¦‚å¯é€‰å±å¹•å’Œå¯¹è¯æ¡†ã€‚

è¦å»¶è¿ŸåŠ è½½åº“ï¼Œå¿…é¡»é¦–å…ˆä½¿ç”¨`deferred as`è¿›è¡Œå¯¼å…¥ã€‚

```dart
import 'package:greetings/hello.dart' deferred as hello;
```

**å½“éœ€è¦åº“æ—¶ï¼Œä½¿ç”¨åº“çš„æ ‡è¯†ç¬¦è°ƒç”¨`loadLibrary()`æ–¹æ³•ã€‚**

```dart
Future greet() async {
  await hello.loadLibrary();
  hello.printGreeting();
}
```

**æ³¨ï¼›**å¯ä»¥åœ¨åº“ä¸Šå¤šæ¬¡è°ƒç”¨loadLibrary()ï¼Œä½†è¯¥åº“åªåŠ è½½ä¸€æ¬¡ã€‚

**åœ¨ä½¿ç”¨å»¶è¿ŸåŠ è½½æ—¶ï¼Œè¯·è®°ä½ä»¥ä¸‹å‡ ç‚¹ï¼š**

- åœ¨å¯¼å…¥æ–‡ä»¶ä¸­ï¼Œé€’å»¶åº“çš„å¸¸é‡ä¸æ˜¯å¸¸é‡ã€‚è®°ä½ï¼Œ**è¿™äº›å¸¸é‡åœ¨å»¶è¿Ÿåº“åŠ è½½ä¹‹å‰æ˜¯ä¸å­˜åœ¨çš„**ã€‚
- ä¸èƒ½åœ¨å¯¼å…¥æ–‡ä»¶ä¸­ä½¿ç”¨æ¥è‡ªå»¶è¿Ÿåº“çš„ç±»å‹ã€‚ç›¸åï¼Œè€ƒè™‘å°†æ¥å£ç±»å‹ç§»åŠ¨åˆ°ç”±å»¶è¿Ÿåº“å’Œå¯¼å…¥æ–‡ä»¶å¯¼å…¥çš„åº“ã€‚
- dart éšå¼åœ°å°†`loadLibrary()`æ’å…¥åˆ°å®šä¹‰ä½¿ç”¨`deferred`ä½œä¸ºåç§°ç©ºé—´çš„åç§°ç©ºé—´ä¸­ã€‚å‡½æ•°çš„ä½œç”¨æ˜¯ï¼šè¿”å›ä¸€ä¸ªæœªæ¥ï¼ˆä¹Ÿå°±æ˜¯ JavaScript ä¸­çš„ Promiseï¼‰ã€‚



### 7.6 åº“çš„å®ç°

**å®ç°åº“çš„æ—¶å€™å¯ä»¥ä¾é `part`å’Œ`part of`å…³é”®å­—ï¼š**

- ä¸ºäº†ç»´æŠ¤ä¸€ä¸ªåº“ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå„ä¸ªåŠŸèƒ½æ”¾åˆ°å„ä¸ª`dart`æ–‡ä»¶ä¸­
- ä½†`part of`æ‰€åœ¨æ–‡ä»¶ä¸èƒ½åŒ…æ‹¬`importã€library`ç­‰å…³é”®å­—
- å¯ä»¥åŒ…å«åœ¨`part`å…³é”®å­—æ‰€åœ¨æ–‡ä»¶ä¸­
- å»ºè®®é¿å…ä½¿ç”¨`part`å’Œ`part of`è¯­å¥ï¼Œå› ä¸ºé‚£æ ·ä¼šä½¿ä»£ç å¾ˆéš¾é˜…è¯»ã€ä¿®æ”¹
- å¯ä»¥å¤šç”¨`library` ã€`part`åŠ å­—ç¬¦ä¸²ç±»å‹çš„ Uri ç±»ä¼¼ includeï¼Œè¡¨ç¤ºåŒ…å«æŸä¸ªæ–‡ä»¶
- `part of`åŠ åº“åè¡¨ç¤ºè¯¥æ–‡ä»¶å±äºé‚£ä¸ªåº“

```dart
// math.dartæ–‡ä»¶å¼€å¤´
library math;
part 'point.dart';
part 'random.dart';

// point.dartæ–‡ä»¶å¼€å¤´
part of math;

// random.dartæ–‡ä»¶å¼€å¤´
part of math;
```

**æœ‰å…³å¦‚ä½•å®ç°åº“åŒ…çš„å»ºè®®ï¼Œè¯·å‚é˜…[åˆ›å»ºåº“åŒ…](https://alanhou.org/docs/dart-documentation/packages/creating-packages/)ï¼ŒåŒ…æ‹¬ï¼š**

- å¦‚ä½•ç»„ç»‡åº“çš„ä»£ç ã€‚
- å¦‚ä½•ä½¿ç”¨ export æŒ‡ä»¤ã€‚
- ä½•æ—¶ä½¿ç”¨ part æŒ‡ä»¤ã€‚



## 8.å¼‚æ­¥æ”¯æŒ

dart ç±»åº“æœ‰éå¸¸å¤šçš„è¿”å›`Future`æˆ–è€…`Stream`å¯¹è±¡çš„å‡½æ•°ã€‚ è¿™äº›å‡½æ•°è¢«ç§°ä¸º**å¼‚æ­¥å‡½æ•°**ï¼šå®ƒä»¬åªä¼šåœ¨è®¾ç½®å¥½ä¸€äº›è€—æ—¶æ“ä½œä¹‹åè¿”å›ï¼Œæ¯”å¦‚åƒ IO æ“ä½œã€‚è€Œä¸æ˜¯ç­‰åˆ°è¿™ä¸ªæ“ä½œå®Œæˆã€‚

**åŒæ—¶ï¼Œ`async`å’Œ`await`å…³é”®è¯æ”¯æŒäº†å¼‚æ­¥ç¼–ç¨‹ï¼Œå…è®¸æ‚¨å†™å‡ºå’ŒåŒæ­¥ä»£ç å¾ˆåƒçš„å¼‚æ­¥ä»£ç ã€‚**

### 8.1 Future

`Future`ä¸ JavaScript ä¸­çš„`Promise`éå¸¸ç›¸ä¼¼ï¼Œè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆå®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰åŠå…¶ç»“æœå€¼çš„è¡¨ç¤ºã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±æ˜¯ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„ï¼Œå¼‚æ­¥å¤„ç†æˆåŠŸäº†å°±æ‰§è¡ŒæˆåŠŸçš„æ“ä½œï¼Œå¼‚æ­¥å¤„ç†å¤±è´¥äº†å°±æ•è·é”™è¯¯æˆ–è€…åœæ­¢åç»­æ“ä½œã€‚**ä¸€ä¸ªFuture åªä¼šå¯¹åº”ä¸€ä¸ªç»“æœï¼Œè¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥ã€‚**

**æ³¨ï¼š**`Future` çš„æ‰€æœ‰APIçš„è¿”å›å€¼ä»ç„¶æ˜¯ä¸€ä¸ª`Future`å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œé“¾å¼è°ƒç”¨ã€‚

#### 8.1.1 Future.then

ä¸ºäº†æ–¹ä¾¿ç¤ºä¾‹ï¼Œåœ¨æœ¬ä¾‹ä¸­ä½¿ç”¨`Future.delayed` åˆ›å»ºäº†ä¸€ä¸ªå»¶æ—¶ä»»åŠ¡ï¼ˆå®é™…åœºæ™¯ä¼šæ˜¯ä¸€ä¸ªçœŸæ­£çš„è€—æ—¶ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼‰ï¼Œå³2ç§’åè¿”å›ç»“æœå­—ç¬¦ä¸²`hi world!`ï¼Œç„¶åæˆ‘ä»¬åœ¨`then`ä¸­æ¥æ”¶å¼‚æ­¥ç»“æœå¹¶æ‰“å°ç»“æœï¼Œä»£ç å¦‚ä¸‹ï¼š

```dart
Future.delayed(new Duration(seconds: 2),(){
   return "hi world!";
}).then((data){
   print(data);
});
```



#### 8.1.2 Future.catchError

å¦‚æœå¼‚æ­¥ä»»åŠ¡å‘ç”Ÿé”™è¯¯ï¼Œå¯ä»¥åœ¨`catchError`ä¸­æ•è·é”™è¯¯ï¼Œå°†ä¸Šé¢ç¤ºä¾‹æ”¹ä¸ºï¼š

```dart
Future.delayed(new Duration(seconds: 2),(){
   //return "hi world!";
   throw AssertionError("Error");  
}).then((data){
   //æ‰§è¡ŒæˆåŠŸä¼šèµ°åˆ°è¿™é‡Œ  
   print("success");
}).catchError((e){
   //æ‰§è¡Œå¤±è´¥ä¼šèµ°åˆ°è¿™é‡Œ  
   print(e);
});
```

`then`æ–¹æ³•è¿˜æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°`onError`ï¼Œä¹Ÿå¯ä»¥å®ƒæ¥æ•è·å¼‚å¸¸ï¼š

```dart
Future.delayed(new Duration(seconds: 2), () {
    //return "hi world!";
    throw AssertionError("Error");
}).then((data) {
    print("success");
}, onError: (e) {
    print(e);
});
```



#### 8.1.3 Future.whenComplete

æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°æ— è®ºå¼‚æ­¥ä»»åŠ¡æ‰§è¡ŒæˆåŠŸæˆ–å¤±è´¥éƒ½éœ€è¦åšä¸€äº›äº‹çš„åœºæ™¯ï¼Œæ¯”å¦‚åœ¨ç½‘ç»œè¯·æ±‚å‰å¼¹å‡ºåŠ è½½å¯¹è¯æ¡†ï¼Œåœ¨è¯·æ±‚ç»“æŸåå…³é—­å¯¹è¯æ¡†ã€‚è¿™ç§åœºæ™¯ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯åˆ†åˆ«åœ¨`then`æˆ–`catch`ä¸­å…³é—­ä¸€ä¸‹å¯¹è¯æ¡†ï¼Œç¬¬äºŒç§å°±æ˜¯ä½¿ç”¨`Future`çš„`whenComplete`å›è°ƒï¼Œæˆ‘ä»¬å°†ä¸Šé¢ç¤ºä¾‹æ”¹ä¸€ä¸‹ï¼š

```dart
Future.delayed(new Duration(seconds: 2),(){
   //return "hi world!";
   throw AssertionError("Error");
}).then((data){
   //æ‰§è¡ŒæˆåŠŸä¼šèµ°åˆ°è¿™é‡Œ 
   print(data);
}).catchError((e){
   //æ‰§è¡Œå¤±è´¥ä¼šèµ°åˆ°è¿™é‡Œ   
   print(e);
}).whenComplete((){
   //æ— è®ºæˆåŠŸæˆ–å¤±è´¥éƒ½ä¼šèµ°åˆ°è¿™é‡Œ
});
```



#### 8.1.4 Future.wait

ä½¿ç”¨`Future.wait`å¯ä»¥åšåˆ°å¤šä¸ª`Future`åŒæ—¶å‡ºå‘æ‰ä¼šè¿›è¡Œåç»­æ“ä½œï¼ŒåŒ JavaScript ä¸­çš„`Promise.all()`æ–¹æ³•ã€‚

`Future.wait`æ¥å—ä¸€ä¸ª`Future`æ•°ç»„å‚æ•°ï¼Œåªæœ‰æ•°ç»„ä¸­æ‰€æœ‰`Future`éƒ½æ‰§è¡ŒæˆåŠŸåï¼Œæ‰ä¼šè§¦å‘`then`çš„æˆåŠŸå›è°ƒï¼Œåªè¦æœ‰ä¸€ä¸ª`Future`æ‰§è¡Œå¤±è´¥ï¼Œå°±ä¼šè§¦å‘é”™è¯¯å›è°ƒã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬é€šè¿‡æ¨¡æ‹Ÿ`Future.delayed` æ¥æ¨¡æ‹Ÿä¸¤ä¸ªæ•°æ®è·å–çš„å¼‚æ­¥ä»»åŠ¡ï¼Œç­‰ä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡éƒ½æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œå°†ä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡çš„ç»“æœæ‹¼æ¥æ‰“å°å‡ºæ¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

```dart
Future.wait([
  // 2ç§’åè¿”å›ç»“æœ  
  Future.delayed(new Duration(seconds: 2), () {
    return "hello";
  }),
  // 4ç§’åè¿”å›ç»“æœ  
  Future.delayed(new Duration(seconds: 4), () {
    return " world";
  })
]).then((results){
  print(results[0]+results[1]);
}).catchError((e){
  print(e);
});

/*
	æœ€åä¼šåœ¨4ç§’åæ‹¿åˆ°ç»“æœ
*/
```

> **æ›´å¤š Future çš„ api è¯·è‡ªè¡ŒæŸ¥è¯¢æ–‡æ¡£ã€‚**



### 8.2 async å’Œ await

å¼‚æ­¥å‡½æ•°æ˜¯å‡½æ•°ä½“è¢«ç”¨`async`ä¿®é¥°ç¬¦æ ‡è®°çš„å‡½æ•°ã€‚
å‘å‡½æ•°ä¸­æ·»åŠ `async`å…³é”®å­—å°†ä½¿å…¶è¿”å›ä¸€ä¸ª Futureã€‚

```dart
String lookUpVersion() => '1.0.0'; // è¿”å›String
```

```dart
Future<String> lookUpVersion() async => '1.0.0'; // è¿”å›Future<String>
```

ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`await`å…³é”®å­—åœ¨å†…éƒ¨ç›´æ¥æ¥å—ä¸€ä¸ª Future çš„`then`çš„æˆåŠŸå›è°ƒï¼Œå°±å¦‚åŒ JavaScript ä¸­çš„é‚£æ ·ï¼š

```dart
task() async {
    try{
        String id = await login("alice","******");
        String userInfo = await getUserInfo(id);
        await saveUserInfo(userInfo);
        // æ‰§è¡Œæ¥ä¸‹æ¥çš„æ“ä½œ   
    } catch(e){
        // é”™è¯¯å¤„ç†   
        print(e);   
    }  
}
```

- `async`ç”¨æ¥è¡¨ç¤ºå‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œå®šä¹‰çš„å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª`Future`å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨thenæ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚
- `await` åé¢æ˜¯ä¸€ä¸ª`Future`ï¼Œè¡¨ç¤ºç­‰å¾…è¯¥å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œå¼‚æ­¥å®Œæˆåæ‰ä¼šå¾€ä¸‹èµ°ã€‚æ³¨æ„ï¼Œ`await`å¿…é¡»å‡ºç°åœ¨ `async` å‡½æ•°å†…éƒ¨ã€‚

**æ³¨æ„ï¼š**å‡½æ•°çš„ä¸»ä½“ä¸éœ€è¦ä½¿ç”¨ Future çš„ APIã€‚å¦‚æœéœ€è¦ï¼Œdartå°†åˆ›å»ºFutureçš„å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰è¿”å›ä¸€ä¸ªæœ‰ç”¨çš„å€¼ï¼Œé‚£ä¹ˆå°†å…¶è¿”å›`Future<void>`ç±»å‹ã€‚



### 8.3 å¤„ç†æµ(Stream)

`Stream` ä¹Ÿæ˜¯ç”¨äºæ¥æ”¶å¼‚æ­¥äº‹ä»¶æ•°æ®ï¼Œå’Œ`Future` ä¸åŒçš„æ˜¯ï¼Œå®ƒå¯ä»¥æ¥æ”¶å¤šä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œå¯ä»¥é€šè¿‡å¤šæ¬¡è§¦å‘æˆåŠŸæˆ–å¤±è´¥äº‹ä»¶æ¥ä¼ é€’ç»“æœæ•°æ®æˆ–é”™è¯¯å¼‚å¸¸ã€‚ `Stream` å¸¸ç”¨äºä¼šå¤šæ¬¡è¯»å–æ•°æ®çš„å¼‚æ­¥ä»»åŠ¡åœºæ™¯ï¼Œå¦‚ç½‘ç»œå†…å®¹ä¸‹è½½ã€æ–‡ä»¶è¯»å†™ç­‰ã€‚

**å½“éœ€è¦ä» Stream è·å–å€¼æ—¶ï¼Œæœ‰ä¸¤ä¸ªé€‰æ‹©:**

- ä½¿ç”¨`async`å’Œå¼‚æ­¥çš„`for`å¾ªç¯ï¼ˆ`await for`ï¼‰

  **æ³¨ï¼š**åœ¨ä½¿ç”¨`await for`ä¹‹å‰ï¼Œè¯·ç¡®ä¿å®ƒä½¿ä»£ç æ›´æ¸…æ™°ï¼Œå¹¶ä¸”ç¡®å®å¸Œæœ›ç­‰å¾…æµï¼ˆStreamï¼‰çš„æ‰€æœ‰ç»“æœã€‚ä¾‹å¦‚ï¼Œé€šå¸¸ä¸åº”è¯¥ä¸º UI äº‹ä»¶ä¾¦å¬å™¨ä½¿ç”¨`await`ï¼Œå› ä¸º UI æ¡†æ¶ä¼šå‘é€æ— ç©·æ— å°½çš„äº‹ä»¶æµã€‚

  **å¼‚æ­¥`for`å¾ªç¯æœ‰ä»¥ä¸‹å½¢å¼ï¼š**

  ```dart
  await for (varOrType identifier in expression) {
    // Executes each time the stream emits a value.
  }
  ```

  è¡¨è¾¾å¼çš„å€¼å¿…é¡»å…·æœ‰ Stream ç±»å‹ã€‚æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹:

  1. ç­‰å¾…æµå‘å‡ºå€¼ã€‚
  2. æ‰§è¡Œ`for`å¾ªç¯çš„ä¸»ä½“ï¼Œå¹¶å°†å˜é‡è®¾ç½®ä¸ºå‘å‡ºçš„å€¼ã€‚
  3. é‡å¤1å’Œ2ï¼Œç›´åˆ°æµå…³é—­ã€‚

  **è¦åœæ­¢ä¾¦å¬æµï¼Œå¯ä»¥ä½¿ç”¨`break`æˆ–`return`è¯­å¥ï¼Œè¯¥è¯­å¥å°†è·³å‡º`for`å¾ªç¯ï¼Œå¹¶ä»æµä¸­å–æ¶ˆè®¢é˜…ã€‚**

  å¦‚æœåœ¨å®ç°å¼‚æ­¥`for`å¾ªç¯æ—¶å‡ºç°ç¼–è¯‘æ—¶é”™è¯¯ï¼Œè¯·ç¡®ä¿`await`åœ¨å¼‚æ­¥å‡½æ•°ä¸­ã€‚ä¾‹å¦‚ï¼Œè¦åœ¨åº”ç”¨ç¨‹åºçš„`main()`å‡½æ•°ä¸­ä½¿ç”¨å¼‚æ­¥`for`å¾ªç¯ï¼Œ`main()`çš„ä¸»ä½“å¿…é¡»æ ‡è®°ä¸º`async`ï¼š

  ```dart
  Future main() async {
    // ...
    await for (var request in requestServer) {
      handleRequest(request);
    }
    // ...
  }
  ```

- ä½¿ç”¨Stream API

  ```dart
  Stream.fromFutures([
    // 1ç§’åè¿”å›ç»“æœ
    Future.delayed(new Duration(seconds: 1), () {
      return "hello 1";
    }),
    // æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
    Future.delayed(new Duration(seconds: 2),(){
      throw AssertionError("Error");
    }),
    // 3ç§’åè¿”å›ç»“æœ
    Future.delayed(new Duration(seconds: 3), () {
      return "hello 3";
    })
  ]).listen((data){
     print(data);
  }, onError: (e){
     print(e.message);
  }, onDone: (){
  
  });
  /*
  ä¸Šé¢çš„ä»£ç ä¾æ¬¡ä¼šè¾“å‡ºï¼š
  I/flutter (17666): hello 1
  I/flutter (17666): Error
  I/flutter (17666): hello 3
  */
  ```
  
  å…·ä½“çš„ Stream çš„ API è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ª Stream çš„å®ä¾‹ç­‰ï¼Œåœ¨è¿™é‡Œå°±ä¸å†èµ˜è¿°ï¼Œæƒ³äº†è§£æ›´å¤šå¯æŸ¥çœ‹ç›¸å…³æ–‡æ¡£ã€‚



## 9.ç”Ÿæˆå™¨

**å½“éœ€è¦å»¶è¿Ÿåœ°ç”Ÿæˆä¸€ä¸ªå€¼åºåˆ—æ—¶ï¼Œè¯·è€ƒè™‘ä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°ã€‚**

dart å†…ç½®æ”¯æŒä¸¤ç§ç”Ÿæˆå™¨å‡½æ•°ï¼š

- åŒæ­¥ç”Ÿæˆå™¨ï¼šè¿”å› Iterable å¯¹è±¡
- å¼‚æ­¥ç”Ÿæˆå™¨ï¼šè¿”å› Stream å¯¹è±¡

è¦å®ç°åŒæ­¥ç”Ÿæˆå™¨å‡½æ•°ï¼Œå°†å‡½æ•°ä½“æ ‡è®°ä¸º`sync*`ï¼Œå¹¶ä½¿ç”¨`yield`è¯­å¥ä¼ é€’å€¼ï¼š

```dart
Iterable<int> naturalsTo(int n) sync* {
  int k = 0;
  while (k < n) yield k++;
}
```

è¦å®ç°å¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°ï¼Œå°†å‡½æ•°ä½“æ ‡è®°ä¸º`async*`ï¼Œå¹¶ä½¿ç”¨`yield`è¯­å¥ä¼ é€’å€¼ï¼š

```dart
Stream<int> asynchronousNaturalsTo(int n) async* {
  int k = 0;
  while (k < n) yield k++;
}
```

å¦‚æœç”Ÿæˆå™¨æ˜¯é€’å½’çš„ï¼Œå¯ä»¥ä½¿ç”¨`yield*`æ¥æ”¹è¿›å®ƒçš„æ€§èƒ½ï¼š

```dart
Iterable<int> naturalsDownFrom(int n) sync* {
  if (n > 0) {
    yield n;
    yield* naturalsDownFrom(n - 1);
  }
}
```



## 10.ç±»å‹å®šä¹‰

åœ¨ dart ä¸­ï¼Œå‡½æ•°æ˜¯å¯¹è±¡ï¼Œå°±åƒå­—ç¬¦ä¸²å’Œæ•°å­—æ˜¯å¯¹è±¡ä¸€æ ·ã€‚`typedef`æˆ–`function-type`ä¸ºå‡½æ•°æä¾›ä¸€ä¸ªç±»å‹åˆ«åï¼Œå¯ä»¥åœ¨å£°æ˜å­—æ®µå’Œè¿”å›ç±»å‹æ—¶ä½¿ç”¨è¿™ä¸ªåç§°ã€‚å½“å‡½æ•°ç±»å‹è¢«åˆ†é…ç»™å˜é‡æ—¶ï¼Œ`typedef`ä¿ç•™ç±»å‹ä¿¡æ¯ã€‚

ä»¥ä¸‹ä»£ç ä¸ä½¿ç”¨`typedef`ï¼š

```dart
class SortedCollection {
  Function compare;

  SortedCollection(int f(Object a, Object b)) {
    compare = f;
  }
}

// Initial, broken implementation.
int sort(Object a, Object b) => 0;

void main() {
  SortedCollection coll = SortedCollection(sort);

  // All we know is that compare is a function,
  // but what type of function?
  assert(coll.compare is Function);
}
```

ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“ç»™`compare`åˆ†é…fæ—¶ç±»å‹ä¿¡æ¯ä¼šä¸¢å¤±ã€‚`f`çš„ç±»å‹æ˜¯`(Object, Object)->int(intè¡¨ç¤ºè¿”å›å€¼ç±»å‹)`ï¼Œå½“ç„¶ï¼Œ`compare`çš„ç±»å‹æ˜¯`Function`ã€‚å¦‚æœæˆ‘ä»¬æ›´æ”¹ä»£ç ä»¥ä½¿ç”¨æ˜¾å¼åç§°å’Œä¿ç•™ç±»å‹ä¿¡æ¯ï¼Œå¼€å‘äººå‘˜å’Œå·¥å…·éƒ½å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯ã€‚

```dart
typedef Compare = int Function(Object a, Object b);

class SortedCollection {
  Compare compare;

  SortedCollection(this.compare);
}

// Initial, broken implementation.
int sort(Object a, Object b) => 0;

void main() {
  SortedCollection coll = SortedCollection(sort);
  assert(coll.compare is Function);
  assert(coll.compare is Compare);
}
```

**æ³¨æ„ï¼š**ç›®å‰ï¼Œ`typedefs`ä»…é™äºå‡½æ•°ç±»å‹ï¼Œå¯èƒ½åœ¨ä¹‹åä¼šæœ‰æ‰€æ”¹å˜ã€‚

å› ä¸º`typedef`ä»…ä»…æ˜¯åˆ«åï¼Œæ‰€ä»¥å®ƒä»¬æä¾›äº†ä¸€ç§æ£€æŸ¥ä»»ä½•å‡½æ•°ç±»å‹çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š

```dart
typedef Compare<T> = int Function(T a, T b);

int sort(int a, int b) => a - b;

void main() {
  assert(sort is Compare<int>); // True!
}
```



## 11.å…ƒæ•°æ®

ä½¿ç”¨å…ƒæ•°æ®æä¾›å…³äºä»£ç çš„é™„åŠ ä¿¡æ¯ã€‚å…ƒæ•°æ®æ³¨é‡Šä»¥å­—ç¬¦`@`å¼€å¤´ï¼Œåè·Ÿå¯¹ç¼–è¯‘æ—¶å¸¸é‡ï¼ˆå¦‚`deprecated`ï¼‰çš„å¼•ç”¨æˆ–å¯¹å¸¸é‡æ„é€ å‡½æ•°çš„è°ƒç”¨ã€‚

æ‰€æœ‰ dart ä»£ç éƒ½å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæ³¨é‡Šï¼š`@deprecated`ï¼ˆå¼ƒç”¨æ³¨é‡Šï¼‰å’Œ`@override`ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨`@deprecated`æ³¨é‡Šçš„ä¾‹å­ï¼š

```dart
class Television {
  /// _Deprecated: Use [turnOn] instead._
  @deprecated
  void activate() {
    turnOn();
  }

  /// Turns the TV's power on.
  void turnOn() {...}
}
```

å¯ä»¥å®šä¹‰è‡ªå·±çš„å…ƒæ•°æ®æ³¨é‡Šï¼ˆä¹Ÿå°±æ˜¯ç±»ä¼¼ JavaScript ä¸­çš„è£…é¥°å™¨çš„æ•ˆæœï¼‰ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå®šä¹‰å¸¦æœ‰ä¸¤ä¸ªå‚æ•°çš„@todoæ³¨é‡Šçš„ç¤ºä¾‹ï¼š

```dart
library todo;

class Todo {
  final String who;
  final String what;

  const Todo(this.who, this.what);
}
```

è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨`@todo`æ³¨é‡Šçš„ä¾‹å­:

```dart
import 'todo.dart';

@Todo('seth', 'make this do something')
void doSomething() {
  print('do something');
}
```

å…ƒæ•°æ®å¯ä»¥å‡ºç°åœ¨åº“ã€ç±»ã€ç±»å‹å®šä¹‰ã€ç±»å‹å‚æ•°ã€æ„é€ å‡½æ•°ã€å·¥å‚ã€å‡½æ•°ã€å­—æ®µã€å‚æ•°æˆ–å˜é‡å£°æ˜ä¹‹å‰ï¼Œä¹Ÿå¯ä»¥å‡ºç°åœ¨å¯¼å…¥æˆ–å¯¼å‡ºæŒ‡ä»¤ä¹‹å‰ã€‚å¯ä»¥ä½¿ç”¨åå°„åœ¨è¿è¡Œæ—¶æ£€ç´¢å…ƒæ•°æ®ã€‚



## 12.dart å¸¸ç”¨åº“çš„ä½¿ç”¨                                                                                                                                                                                                                                                                                                                     

[dart å¸¸ç”¨åº“çš„ä½¿ç”¨](https://www.kancloud.cn/marswill/dark2_document/728986)

